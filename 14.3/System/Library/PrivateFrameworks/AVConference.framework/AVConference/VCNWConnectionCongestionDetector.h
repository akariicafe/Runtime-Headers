@class AVCStatisticsCollector;

@interface VCNWConnectionCongestionDetector : NSObject {
    struct { int type; double arrivalTime; BOOL isVCRCInternal; BOOL shouldDrainAndProcess; BOOL statisticsUpdateOnly; union { struct { unsigned int queueDepth1; unsigned int queueDepth2; unsigned int txBitrate; unsigned int averageBitrate; unsigned int averageBitrateLong; double averageQueueDepth; double expectedQueuingDelay; double bdcd; double normalizedBDCD; double normalizedDelay; char bbString[64]; int radioTechnology; } baseband; struct { unsigned int sendTimestamp; unsigned int queuingDelay; unsigned int remoteBWEstimation; unsigned int remoteBWEStability; unsigned int maxVideoBurstyLoss; unsigned int audioConsecutiveLoss; unsigned int mostBurstyLoss; unsigned int audioReceivedPackets; unsigned int videoReceivedPackets; unsigned int totalSentPackets; unsigned int echoedSendTimestamp; double owrd; double packetLossRate; unsigned int actualBitrate; unsigned int instantBitrate; double roundTripTime; unsigned int receiveQueueTarget; BOOL isPacketReceivedValid; struct { int packetType; unsigned int packetId; unsigned int sampleRate; unsigned int totalPacketsReceived; double receiveTimestamp; double owrd; double targetJitterQueueSize; unsigned int bandwidthEstimation; unsigned int localBurstyLoss; } packetReceived; } feedback; struct { double packetLossPercentage; double packetLossPercentageAudio; double packetLossPercentageVideo; unsigned int burstPacketLoss; unsigned int roundTripTimeMilliseconds; unsigned int isNetworkCongested; unsigned int owrd; unsigned int targetBitrate; unsigned long long statisticsID; unsigned int videoPacketsReceived; } network; struct { unsigned int estimatorID; BOOL deregisterEstimator; BOOL isProbingSequence; BOOL isEndOfProbingSequence; unsigned int probingSequenceID; unsigned int messageLength; double arrivalTime; unsigned int mediaTimestamp; BOOL isPacketReceivedValid; struct { int packetType; unsigned int packetId; unsigned int sampleRate; unsigned int totalPacketsReceived; double receiveTimestamp; double owrd; double targetJitterQueueSize; unsigned int bandwidthEstimation; unsigned int localBurstyLoss; } packetReceived; } probing; struct { unsigned char linkID; unsigned int sendTimestamp; unsigned int receiveTimestamp; unsigned int totalPacketSent; unsigned int totalPacketReceived; unsigned int totalByteSent; unsigned int totalByteReceived; unsigned int serverStatsByteUsed; unsigned int bandwidthSample; unsigned int bandwidthEstimation; double roundTripTime; double owrd; double packetLossRate; unsigned int actualBitrate; unsigned int serverStatsBitrate; unsigned int expectedBitrate; } serverStats; struct { unsigned int packetId; unsigned int totalPacketsSent; unsigned int totalBytesSent; double sendTimestamp; } packetSent; struct { int packetType; unsigned int packetId; unsigned int sampleRate; unsigned int totalPacketsReceived; double receiveTimestamp; double owrd; double targetJitterQueueSize; unsigned int bandwidthEstimation; unsigned int localBurstyLoss; } packetReceived; struct { unsigned int ssrc; unsigned int packetLossPercentage; unsigned int lastSequenceNumber; unsigned int roundTripTimeMilliseconds; } rtcpRR; struct { unsigned int mode; unsigned int remoteRadioAccessTechnology; unsigned int localRadioAccessTechnology; unsigned int maxBitrate; unsigned int minBitrate; unsigned int initialBitrate; unsigned int featureFlags; } config; struct { unsigned int mediaEventType; unsigned int additionalFlushCount; unsigned int transactionID; unsigned int audioStallBitrate; BOOL isKeyFrame; unsigned int refreshFrameTimestamp; unsigned int refreshFramePayloadType; unsigned int refreshFramePacketCount; } mediaEvent; struct { unsigned char version; unsigned char direction; unsigned long long timestamp; unsigned long long maxThroughputBps; unsigned long long totalByteCount; unsigned int flushableQueueSize; unsigned int nonFlushableQueueSize; unsigned int averageDelayMillisecond; unsigned long long averageThroughputBps; int rateTrendSuggestion; unsigned int packetLossPerFrame; } nwConnection; } ; } _previousStatistics;
    unsigned int _lastTimestampWithPacketDrop;
    unsigned int _packetDropCountPerFrame;
    BOOL _didSendCongestionEvent;
    void *_logNWDump;
}

@property (retain, nonatomic) AVCStatisticsCollector *statisticsCollector;
@property (readonly) unsigned int averageThroughputBps;
@property (readonly) unsigned int averagePacketDelayMs;
@property unsigned int maxAveragePacketDelayMs;
@property (readonly) unsigned int packetDropCount;

- (void)dealloc;
- (void)enableNWLogDump:(void *)a0;
- (void)sendCongestionEventWithTimestamp:(unsigned int)a0;
- (BOOL)processNWConnectionNotification:(struct ifnet_interface_advisory { unsigned char x0; unsigned char x1; unsigned short x2; int x3; unsigned long long x4; unsigned long long x5; unsigned long long x6; unsigned long long x7; unsigned int x8; unsigned int x9; unsigned int x10; } *)a0;
- (BOOL)processNWConnectionPacketEvent:(struct packet_id { unsigned char x0; unsigned char x1; unsigned short x2; unsigned int x3; unsigned int x4; unsigned int x5; } *)a0 eventType:(int)a1;

@end
