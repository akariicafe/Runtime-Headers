@class NSMapTable, TSPSupportManager, TSPPackageWriteCoordinator, NSHashTable, TSPObjectContainer, NSMutableArray, NSString, TSUTemporaryDirectory, TSPDocumentRevision, TSPPackage, NSMutableDictionary, TSPCancellationState, NSRecursiveLock, TSPDocumentSaveOperationState, TSPDocumentProperties, NSSet, TSPDataManager, TSPObject, TSPSupportMetadata, NSData, TSPObjectUUIDMap, NSObject, TSPSupportPackageWriteCoordinator, TSPResourceContext, TSPDataDownloadManager, TSPComponentManager, TSPDocumentMetadata, TSPRegistry, NSURL, NSProgress, SFUCryptoKey, NSUUID;
@protocol OS_dispatch_group, NSFilePresenter, TSPObjectContextDelegate, OS_dispatch_queue;

@interface TSPObjectContext : NSObject <TSPFileCoordinatorDelegate, TSPLazyReferenceDelegate, TSPObjectDelegate, TSPSupportDirectoryDelegate, TSPPassphraseConsumer> {
    _Atomic long long _lastObjectIdentifier;
    _Atomic long long _modifyObjectToken;
    _Atomic int _modifyObjectCount;
    _Atomic BOOL _didClose;
    unsigned int _mode;
    SFUCryptoKey *_decryptionKey;
    NSURL *_documentURL;
    TSPPackage *_documentPackage;
    TSPPackage *_supportPackage;
    NSURL *_supportURL;
    NSProgress *_readProgress;
    TSPCancellationState *_readCancellationState;
    struct os_unfair_lock_s { unsigned int _os_unfair_lock_opaque; } _documentPropertiesLock;
    TSPDocumentProperties *_documentProperties;
    NSMapTable *_objects;
    TSPObjectUUIDMap *_objectUUIDMap;
    NSMutableDictionary *_deterministicObjectUUIDSetPerObject;
    TSPDocumentRevision *_documentRevision;
    long long _preferredPackageType;
    NSSet *_featureIdentifiers;
    NSSet *_unsupportedFeatureIdentifiers;
    NSObject<OS_dispatch_queue> *_objectsQueue;
    NSObject<OS_dispatch_queue> *_writeQueue;
    NSRecursiveLock *_readLock;
    NSObject<OS_dispatch_queue> *_documentStateQueue;
    NSObject<OS_dispatch_queue> *_dataAttributesQueue;
    NSObject<OS_dispatch_queue> *_loadObserversQueue;
    NSObject<OS_dispatch_queue> *_runLoadObserversQueue;
    NSObject<OS_dispatch_queue> *_runLoadObserversForKnownObjectQueue;
    NSObject<OS_dispatch_queue> *_resourceAccessQueue;
    NSObject<OS_dispatch_queue> *_notificationQueue;
    NSProgress *_nextSaveProgress;
    TSPDocumentSaveOperationState *_saveOperationState;
    TSPPackageWriteCoordinator *_packageWriteCoordinator;
    NSHashTable *_objectsToIgnoreModifications;
    NSHashTable *_objectModifyDelegates;
    BOOL _isWaitingForEndSave;
    NSObject<OS_dispatch_group> *_pendingEndSaveGroup;
    NSObject<OS_dispatch_group> *_outstandingReadsGroup;
    NSObject<OS_dispatch_queue> *_temporaryDirectoryQueue;
    TSUTemporaryDirectory *_temporaryDirectory;
    struct unordered_map<const long long, NSMutableArray *, TSP::IdentifierHash, std::__1::equal_to<const long long>, std::__1::allocator<std::__1::pair<const long long, NSMutableArray *> > > { struct __hash_table<std::__1::__hash_value_type<const long long, NSMutableArray *>, std::__1::__unordered_map_hasher<const long long, std::__1::__hash_value_type<const long long, NSMutableArray *>, TSP::IdentifierHash, true>, std::__1::__unordered_map_equal<const long long, std::__1::__hash_value_type<const long long, NSMutableArray *>, std::__1::equal_to<const long long>, true>, std::__1::allocator<std::__1::__hash_value_type<const long long, NSMutableArray *> > > { struct unique_ptr<std::__1::__hash_node_base<std::__1::__hash_node<std::__1::__hash_value_type<const long long, NSMutableArray *>, void *> *> *[], std::__1::__bucket_list_deallocator<std::__1::allocator<std::__1::__hash_node_base<std::__1::__hash_node<std::__1::__hash_value_type<const long long, NSMutableArray *>, void *> *> *> > > { struct __compressed_pair<std::__1::__hash_node_base<std::__1::__hash_node<std::__1::__hash_value_type<const long long, NSMutableArray *>, void *> *> **, std::__1::__bucket_list_deallocator<std::__1::allocator<std::__1::__hash_node_base<std::__1::__hash_node<std::__1::__hash_value_type<const long long, NSMutableArray *>, void *> *> *> > > { struct __hash_node_base<std::__1::__hash_node<std::__1::__hash_value_type<const long long, NSMutableArray *>, void *> *> **__value_; struct __bucket_list_deallocator<std::__1::allocator<std::__1::__hash_node_base<std::__1::__hash_node<std::__1::__hash_value_type<const long long, NSMutableArray *>, void *> *> *> > { struct __compressed_pair<unsigned long, std::__1::allocator<std::__1::__hash_node_base<std::__1::__hash_node<std::__1::__hash_value_type<const long long, NSMutableArray *>, void *> *> *> > { unsigned long long __value_; } __data_; } __value_; } __ptr_; } __bucket_list_; struct __compressed_pair<std::__1::__hash_node_base<std::__1::__hash_node<std::__1::__hash_value_type<const long long, NSMutableArray *>, void *> *>, std::__1::allocator<std::__1::__hash_node<std::__1::__hash_value_type<const long long, NSMutableArray *>, void *> > > { struct __hash_node_base<std::__1::__hash_node<std::__1::__hash_value_type<const long long, NSMutableArray *>, void *> *> { struct __hash_node_base<std::__1::__hash_node<std::__1::__hash_value_type<const long long, NSMutableArray *>, void *> *> *__next_; } __value_; } __p1_; struct __compressed_pair<unsigned long, std::__1::__unordered_map_hasher<const long long, std::__1::__hash_value_type<const long long, NSMutableArray *>, TSP::IdentifierHash, true> > { unsigned long long __value_; } __p2_; struct __compressed_pair<float, std::__1::__unordered_map_equal<const long long, std::__1::__hash_value_type<const long long, NSMutableArray *>, std::__1::equal_to<const long long>, true> > { float __value_; } __p3_; } __table_; } _loadObservers;
    NSObject<OS_dispatch_queue> *_asynchronousObjectModifierQueue;
    NSHashTable *_asynchronousObjectModifiers;
    NSMutableArray *_suspendedAsynchronousObjectModifierStack;
    TSPObject *_supportObject;
    TSPSupportPackageWriteCoordinator *_supportWriteCoordinator;
    NSHashTable *_objectProviders;
    NSObject<OS_dispatch_queue> *_objectProvidersQueue;
    struct { unsigned char delegateRespondsToAdditionalDocumentPropertiesForWrite : 1; unsigned char delegateRespondsToAdditionalDocumentSupportPropertiesForWrite : 1; unsigned char delegateRespondsToDocumentPasswordHintForWrite : 1; unsigned char delegateRespondsToPackageDataForWrite : 1; unsigned char delegateRespondsToAreNewExternalReferencesToDataAllowed : 1; unsigned char delegateRespondsToAreExternalReferencesToDataAllowedAtURL : 1; unsigned char delegateRespondsToBaseUUIDForObjectUUID : 1; unsigned char delegateRespondsToPreserveDocumentRevisionIdentifierForSaveURL : 1; unsigned char delegateRespondsToFilePresenter : 1; unsigned char delegateRespondsToSupportDirectoryURLReturningIsUnique : 1; unsigned char delegateRespondsToSupportDirectoryURL : 1; unsigned char delegateRespondsToArchiveValidationMode : 1; unsigned char delegateRespondsToIgnoreDocumentSupport : 1; unsigned char delegateRespondsToIsDocumentSupportTemporary : 1; unsigned char delegateRespondsToShouldLoadAllComponents : 1; unsigned char delegateRespondsToIsInCollaborationMode : 1; unsigned char delegateRespondsToIsInReadOnlyMode : 1; unsigned char delegateRespondsToContextDidUpdateDocumentRevision : 1; unsigned char skipDocumentUpgrade : 1; } _flags;
}

@property (readonly, nonatomic) TSPRegistry *registry;
@property (readonly, nonatomic) id<NSFilePresenter> filePresenter;
@property (readonly, nonatomic) BOOL ignoreDocumentSupport;
@property (readonly, nonatomic) BOOL isDocumentSupportTemporary;
@property (readonly, nonatomic) BOOL ignoreDocumentSupportVersioning;
@property (readonly, nonatomic) BOOL ignoreUnknownContentWhileReading;
@property (readonly, nonatomic) BOOL ignoreVersionCheckingWhileReading;
@property (readonly, nonatomic) BOOL ignoreDocumentResourcesWhileReading;
@property (readonly, nonatomic) BOOL isInCollaborationMode;
@property (readonly, nonatomic) TSPComponentManager *componentManager;
@property (readonly, nonatomic) TSPResourceContext *resourceContext;
@property (readonly, nonatomic) TSPDataManager *dataManager;
@property (readonly, nonatomic) TSPDataDownloadManager *dataDownloadManager;
@property (readonly, nonatomic) TSPSupportManager *supportManager;
@property (readonly, nonatomic) TSPPackage *documentPackage;
@property (readonly, nonatomic) TSPPackage *supportPackage;
@property (readonly, nonatomic) TSPObjectContainer *documentObjectContainer;
@property (readonly, nonatomic) TSPObjectContainer *supportObjectContainer;
@property (readonly, nonatomic) TSPDocumentMetadata *documentMetadata;
@property (readonly, nonatomic) TSPSupportMetadata *supportMetadata;
@property (nonatomic) long long lastObjectIdentifier;
@property (readonly, nonatomic) unsigned long long saveToken;
@property (readonly, nonatomic) NSData *passwordVerifier;
@property (readonly, nonatomic) BOOL areNewExternalReferencesToDataAllowed;
@property (readonly, nonatomic) NSUUID *documentUUID;
@property (readonly, nonatomic) NSUUID *versionUUID;
@property (retain, nonatomic) TSPObject *supportObject;
@property (readonly) long long aggregateReadabilityForDocumentResources;
@property (readonly, nonatomic) SFUCryptoKey *decryptionKey;
@property (readonly, nonatomic) BOOL isReadCancelled;
@property (readonly, nonatomic) NSURL *documentURL;
@property (nonatomic) BOOL nested;
@property (readonly, nonatomic) BOOL hasCurrentFileFormatVersion;
@property (readonly, nonatomic) unsigned long long documentReadVersion;
@property (readonly, nonatomic) NSSet *featureIdentifiers;
@property (readonly, nonatomic) BOOL losesDataOnWrite;
@property (readonly, nonatomic) NSSet *unsupportedFeatureIdentifiers;
@property (readonly) BOOL closed;
@property (readonly, nonatomic) BOOL isDocumentModified;
@property (readonly, nonatomic) BOOL isSupportModified;
@property (readonly, nonatomic) BOOL isPasswordProtected;
@property (readonly, nonatomic) NSString *documentPasswordHint;
@property (readonly, nonatomic) BOOL isInReadOnlyMode;
@property (readonly, nonatomic) TSPDocumentProperties *documentProperties;
@property (readonly, nonatomic) TSPObject *documentObject;
@property (weak, nonatomic) id<TSPObjectContextDelegate> delegate;
@property (readonly, nonatomic) long long packageType;
@property long long preferredPackageType;
@property (readonly, nonatomic) unsigned long long documentSize;
@property (readonly, nonatomic) unsigned long long documentDataSize;
@property (readonly, nonatomic) unsigned long long documentObjectSize;
@property (retain) TSPDocumentRevision *documentRevision;
@property (readonly) unsigned long long hash;
@property (readonly) Class superclass;
@property (readonly, copy) NSString *description;
@property (readonly, copy) NSString *debugDescription;
@property (readonly, nonatomic) BOOL ignoreReferencesToUnknownObjects;
@property (readonly, nonatomic) TSPObjectContext *context;
@property (readonly, nonatomic) NSString *lastPasswordAttempted;
@property (readonly, nonatomic) NSString *passphraseHint;
@property (readonly, nonatomic) NSData *keychainGenericItem;
@property (readonly, nonatomic) BOOL requiresNetworkValidation;

+ (void)waitForPendingEndSaveGroup:(id)a0;
+ (long long)documentTypeAtURL:(id)a0 hasNativeUTI:(BOOL)a1;
+ (BOOL)isNativeDirectoryFormatURL:(id)a0;
+ (BOOL)isTangierEditingDirectoryFormatURL:(id)a0;
+ (BOOL)isTangierEditingFormatURL:(id)a0;
+ (id)releaseQueue;
+ (id)supportBundleURLForDocumentUUID:(id)a0 delegate:(id)a1;
+ (void)garbageCollectDocumentSupportWithKnownDocumentUUIDs:(id)a0 delegate:(id)a1;
+ (BOOL)dumpMessagesForDocument:(id)a0 decryptionKey:(id)a1 toURL:(id)a2;
+ (long long)documentTypeAtURL:(id)a0;
+ (long long)documentTypeAtURL:(id)a0 hasNativeUTI:(BOOL)a1 nestedDocumentFilename:(id)a2;
+ (id)documentRevisionAtURL:(id)a0 passphrase:(id)a1 error:(id *)a2;
+ (void)removeDefaultSupportDirectory;

- (id)temporaryDirectory;
- (id)init;
- (void)close;
- (void).cxx_destruct;
- (BOOL)setPassphrase:(id)a0;
- (void)dealloc;
- (void)setDocumentProperties:(id)a0;
- (id).cxx_construct;
- (id)initWithDelegate:(id)a0;
- (id)objectForIdentifier:(long long)a0;
- (id)initWithURL:(id)a0 delegate:(id)a1 error:(id *)a2;
- (long long)modifyObjectTokenForNewObject;
- (void)setDocumentObject:(id)a0;
- (long long)newObjectIdentifier;
- (BOOL)areExternalReferencesSupported;
- (BOOL)areExternalReferencesToDataAllowedAtURL:(id)a0;
- (void)addLoadObserver:(id)a0 action:(SEL)a1 forObjectIdentifier:(long long)a2 objectOrNil:(id)a3;
- (void)beginWriteOperation;
- (void)endWriteOperation;
- (void)performReadOperation:(id /* block */)a0;
- (void)beginAssertOnModify;
- (void)endAssertOnModify;
- (void)performReadOperationOnKnownObjects:(id /* block */)a0;
- (void)checkforDataWarningsWithPackageURL:(id)a0;
- (void)beginIgnoringCachedObjectEviction;
- (void)endIgnoringCachedObjectEviction;
- (void)didMoveToURL:(id)a0;
- (void)didMoveSupportToURL:(id)a0;
- (void)suspendLoadingModifiedFlushedComponentsAndWait;
- (void)resumeLoadingModifiedFlushedComponents;
- (void)waitForSaveToFinishIfNeeded;
- (void)didReadDocumentObject:(id)a0;
- (long long)incrementLastObjectIdentifier:(long long)a0;
- (long long)updateModifyObjectToken;
- (id)addLoadedObjectsAndEnqueueNotifications:(id)a0;
- (void)addLoadObserver:(id)a0 action:(SEL)a1 forLazyReference:(id)a2;
- (void)presentPersistenceError:(id)a0;
- (void)performReadUsingAccessor:(id /* block */)a0;
- (id)objectWithUUID:(id)a0;
- (id)objectWithUUIDIfAvailableAndLoaded:(id)a0;
- (id)objectWithUUIDIfAvailable:(id)a0;
- (id)objectWithUUIDPath:(id)a0;
- (id)dataWithContentsOfPackagePath:(id)a0;
- (id)initForQuickLookWithURL:(id)a0 registry:(id)a1 delegate:(id)a2 passphrase:(id)a3 error:(id *)a4;
- (id)supportDirectoryURLReturningIsBundleURL:(BOOL *)a0;
- (void)suspendAutosaveWithReason:(id)a0;
- (void)resumeAutosaveWithReason:(id)a0;
- (void)suspendSaveAndAutosaveWithReason:(id)a0;
- (void)resumeSaveAndAutosaveWithReason:(id)a0;
- (void)requestAutosave;
- (void)requestAutosaveForExpensiveCalculation;
- (long long)archiveValidationMode;
- (id)baseUUIDForObjectUUID;
- (BOOL)setDecryptionKey:(id)a0;
- (void)beginSaveToURL:(id)a0 updateType:(long long)a1 packageType:(long long)a2 documentUUID:(id)a3;
- (void)beginWriteWithOriginalURL:(id)a0;
- (BOOL)writeToURL:(id)a0 encryptionKey:(id)a1 error:(id *)a2;
- (BOOL)endWriteWithSuccess:(BOOL)a0 error:(id *)a1;
- (void)endSaveWithSuccess:(BOOL)a0;
- (id)newObjectUUIDForObject:(id)a0 uuidNamespace:(unsigned char)a1 offset:(unsigned long long)a2 ignoringBaseUUIDForObjectUUID:(BOOL)a3 requireDeterministicUUID:(BOOL)a4;
- (void)beginIgnoringModificationsForObject:(id)a0;
- (void)endIgnoringModificationsForObject:(id)a0;
- (void)willModifyObject:(id)a0 options:(unsigned long long)a1;
- (BOOL)canModifyObject:(id)a0;
- (BOOL)canSetObjectUUIDForObject:(id)a0;
- (id)objectUUIDMap;
- (id)initWithDelegate:(id)a0 registry:(id)a1 resourceContext:(id)a2;
- (void)createInternalMetadataIfNeeded;
- (id)initWithURL:(id)a0 delegate:(id)a1 passphrase:(id)a2 error:(id *)a3;
- (id)initWithURL:(id)a0 delegate:(id)a1 resourceContext:(id)a2 passphrase:(id)a3 skipDocumentUpgrade:(BOOL)a4 error:(id *)a5;
- (id)initWithURL:(id)a0 delegate:(id)a1 resourceContext:(id)a2 mode:(unsigned int)a3 passphrase:(id)a4 skipDocumentUpgrade:(BOOL)a5 error:(id *)a6;
- (id)initWithURL:(id)a0 delegate:(id)a1 registry:(id)a2 resourceContext:(id)a3 mode:(unsigned int)a4 passphrase:(id)a5 skipDocumentUpgrade:(BOOL)a6 error:(id *)a7;
- (BOOL)readDocumentObjectFromPackageURL:(id)a0 error:(id *)a1;
- (BOOL)readDocumentObjectFromDatabasePackageURL:(id)a0 error:(id *)a1;
- (void)updateAdditionalResourceRequests;
- (void)closeFromDealloc:(BOOL)a0;
- (void)beginWriteWithOriginalURL:(id)a0 relativeURLForExternalData:(id)a1;
- (void)suspendAsynchronousModificationsForObjectTargetType:(unsigned long long)a0;
- (void)performReadOperationOnDataAttributes:(id /* block */)a0;
- (BOOL)writeToURL:(id)a0 originalPackage:(id)a1 supportURL:(id)a2 originalSupportPackage:(id)a3 encryptionKey:(id)a4 error:(id *)a5;
- (unsigned long long)estimatedProgressTotalUnitCountForURL:(id)a0 packageType:(long long)a1;
- (BOOL)shouldUseCloneModeToWriteToURL:(id)a0 originalURL:(id)a1;
- (BOOL)copyIfAppropriateFromOriginalURL:(id)a0 toURL:(id)a1 cloneMode:(BOOL)a2 originalPackage:(id)a3 packageType:(long long)a4 inheritAttributes:(BOOL)a5;
- (void)performAsynchronousWriteOperationOnDocumentState:(id /* block */)a0;
- (void)resumeAsynchronousModifications;
- (void)prepareForDocumentReplacementWithSuccess:(BOOL)a0 forSafeSave:(BOOL)a1;
- (void)beginSaveToURL:(id)a0 updateType:(long long)a1 packageType:(long long)a2;
- (void)performReadOperationOnDocumentState:(id /* block */)a0;
- (BOOL)continueReadingDocumentObjectFromPackageURL:(id)a0 areExternalDataReferencesAllowed:(BOOL)a1 error:(id *)a2;
- (void)prepareToReadSupportObjectExternalDataReferencesAllowed:(BOOL)a0 accessor:(id /* block */)a1;
- (BOOL)readWithReadCoordinator:(id)a0 finalizeHandlerQueue:(id)a1 rootObject:(id *)a2 error:(id *)a3 readCompletion:(id /* block */)a4;
- (BOOL)continueReadingDocumentObjectFromDatabasePackageURL:(id)a0 error:(id *)a1;
- (void)didReadSupportObject:(id)a0;
- (BOOL)didFinishSuccessfullyReadingObjects:(id)a0 readCoordinator:(id)a1 finalizeHandlerQueue:(id)a2;
- (void)setSupportObjectImpl:(id)a0;
- (BOOL)readComponent:(id)a0 isWeakReference:(BOOL)a1 documentPackage:(id)a2 supportPackage:(id)a3 rootObject:(id *)a4 allObjects:(id *)a5 error:(id *)a6;
- (void)performReadUsingAccessorImpl:(id /* block */)a0;
- (BOOL)readObjectForIdentifier:(long long)a0 isWeakReference:(BOOL)a1 ignoreUnknownContentWhileReading:(BOOL)a2 rootObjectComponent:(id)a3 object:(id *)a4 error:(id *)a5;
- (BOOL)readComponent:(id)a0 isWeakReference:(BOOL)a1 rootObject:(id *)a2 allObjects:(id *)a3 error:(id *)a4;
- (void)conditionallyBeginAccessingResourcesWithCompletionQueue:(id)a0 completionHandler:(id /* block */)a1;
- (id)performResourceAccessUsingQueue:(id)a0 block:(id /* block */)a1;
- (void)enumerateDocumentResourcesUsingBlock:(id /* block */)a0;
- (id)objectWithUUID:(id)a0 onlyIfLoaded:(BOOL)a1 validateNewObjects:(BOOL)a2 identifier:(long long *)a3;
- (BOOL)readLazyReference:(id)a0 object:(id *)a1 error:(id *)a2;
- (BOOL)isObjectInDocument:(id)a0;
- (void)performAsynchronousWriteOperationOnDataAttributes:(id /* block */)a0;
- (id)prepareSaveProgress;
- (id)currentPackageDataWriter;
- (BOOL)saveToURL:(id)a0 packageType:(long long)a1 encryptionKey:(id)a2 originalURL:(id)a3 error:(id *)a4;
- (void)replaceDocumentObject:(id)a0;
- (unsigned long long)sizeOfComponentsWithLocator:(id)a0;
- (id)incrementDocumentRevisionWithIdentifier:(id)a0;
- (void)resetDocumentRevision;
- (id)readObjectIfNeededForIdentifier:(long long)a0 isWeakReference:(BOOL)a1 componentIdentifier:(long long)a2;
- (id)documentResourceDataForDigestString:(id)a0 locator:(id)a1 filename:(id)a2 canDownload:(BOOL)a3;
- (BOOL)containsDataConformingToUTI:(id)a0;
- (void)addObjectModifyDelegate:(id)a0;
- (void)removeObjectModifyDelegate:(id)a0;
- (void)registerAsynchronousObjectModifier:(id)a0;
- (BOOL)canPerformUserActions;
- (void)canPerformUserActionUsingBlock:(id /* block */)a0;
- (id)initForSpotlightWithURL:(id)a0 delegate:(id)a1 registry:(id)a2 error:(id *)a3;
- (id)initWithPartialDocumentURL:(id)a0 delegate:(id)a1 passphrase:(id)a2 error:(id *)a3;
- (void)prepareForDocumentReplacement;
- (void)registerObjectProvider:(id)a0;
- (void)enumerateObjectProvidersUsingBlock:(id /* block */)a0;
- (BOOL)shouldLoadAllComponentsForDocumentURL:(id)a0;
- (BOOL)updateDocumentUUIDPreserveOriginalDocumentSupport:(BOOL)a0 preserveShareUUID:(BOOL)a1 error:(id *)a2;
- (id)dataWithDigest:(id)a0 preferredFilename:(id)a1 canDownload:(BOOL)a2 isMissingFromServer:(BOOL)a3 downloadPriority:(long long)a4;
- (id)dataWithDigest:(id)a0;
- (id)objectsFromUUIDs:(id)a0;
- (id)UUIDsFromObjects:(id)a0;
- (id)dataWithLegacyDataIdentifier:(long long)a0;

@end
