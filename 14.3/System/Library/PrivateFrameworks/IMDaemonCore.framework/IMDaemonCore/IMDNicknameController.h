@class NSMutableDictionary, IMNickname, NSMutableSet, NSSet, IDSKVStore, NSMutableArray;

@interface IMDNicknameController : NSObject <IMSystemMonitorListener>

@property (retain, nonatomic) IDSKVStore *kvStore;
@property (nonatomic) double lastMeContactStoreSync;
@property (retain, nonatomic) IDSKVStore *handledNicknamesKVStore;
@property (retain, nonatomic) IDSKVStore *pendingNicknameUpdatesKVStore;
@property (retain, nonatomic) IDSKVStore *handleSharingKVStore;
@property (retain, nonatomic) NSMutableDictionary *handledNicknames;
@property (retain, nonatomic) NSMutableDictionary *pendingNicknameUpdates;
@property (retain, nonatomic) NSMutableSet *handleWhitelist;
@property (retain, nonatomic) NSMutableSet *handleBlacklist;
@property (retain, nonatomic) IMNickname *personalNickname;
@property (nonatomic) BOOL needToLoadMapsInfoFromDisk;
@property (retain, nonatomic) NSMutableArray *chatsToSendNicknameInfoTo;
@property (nonatomic) BOOL nicknameIsUploadingToCK;
@property (readonly, nonatomic) NSSet *whitelistedHandlesForSharing;
@property (readonly, nonatomic) NSSet *blacklistedHandlesForSharing;

+ (id)sharedInstance;

- (BOOL)_deviceUnderFirstUnlock;
- (void)_deleteDataUnderScrutiny;
- (void)_showDebugAlertWithHeader:(id)a0 message:(id)a1;
- (void)deleteAllPersonalNicknames:(BOOL)a0 withCompletion:(id /* block */)a1;
- (BOOL)_isUnderScrutiny;
- (void)sendNicknamePreferencesDidChange;
- (void)deviceSignedOutOfiMessage;
- (void)_deleteHandleIDFromPendingMap:(id)a0;
- (void)verifyTruncatedRecordIDMatchesPersonalNickname:(id)a0 forChat:(id)a1;
- (void)setPersonalNickname:(id)a0 completionBlock:(id /* block */)a1;
- (void)_syncHandleWhitelistBlacklistToOtherDevices;
- (id)allNicknames;
- (id)init;
- (void)_clearSharingLists;
- (void)ignorePendingNicknameForHandleID:(id)a0;
- (id)pendingPersonalNickname;
- (void)_storePendingNicknameForUpload:(id)a0;
- (void)_ckAccountChanged:(id)a0;
- (void)_writeNicknameToKVStore:(id)a0 nickname:(id)a1;
- (void)_setUnderScrutiny:(BOOL)a0;
- (void)_updateHandleBlacklistWhitelistIfNeeded:(id)a0;
- (id)defaults;
- (void)dealloc;
- (void)queueChatToSendNicknamePostUploadIfNeeded:(id)a0;
- (void)_evaluateIfAccountHasMultiplePhoneNumbers;
- (void)_updateHandleList:(id)a0 withHandles:(id)a1 forKey:(id)a2 broadcastUpdates:(BOOL)a3;
- (void)cleanUpNicknameForID:(id)a0;
- (BOOL)_sendMessageDictionary:(id)a0 toDevice:(id)a1;
- (void)_updateCloudKitRecordIDAndDecryptionKeyIfNeededFromMadridMessage:(id)a0;
- (void)blacklistHandlesForSharing:(id)a0;
- (void)newDeviceDidSignIntoiMessage;
- (void)addNicknameToPendingUpdates:(id)a0;
- (void)_updateMessageDictionaryWithPendingNicknameUpdates:(id)a0;
- (void)clearPendingNicknameForHandleID:(id)a0;
- (id)nickNameDecryptionKey;
- (BOOL)_isNicknamesSharingEnabled;
- (void)_endNicknameUpload;
- (BOOL)replacedNicknameForHandleIDInHandledMapIfNeeded:(id)a0 nickname:(id)a1;
- (id)nicknameForRecordID:(id)a0 handle:(id)a1;
- (void)_loadAllInfoFromDiskIfAble;
- (void)_retryPeerRequestWithRetry:(unsigned long long)a0;
- (void)reuploadProfileIfNeeded;
- (void)systemDidLeaveFirstDataProtectionLock;
- (void)_updateNicknameInHandledMap:(id)a0;
- (void)_deletePublicNicknameLocationAndKey;
- (void)_uploadPendingNicknameIfNecessary;
- (void)_deleteHandleIDFromHandledMap:(id)a0;
- (void)sendPersonalNicknameToChat:(id)a0;
- (void)_updatePendingNicknameVersion;
- (void)handleNicknameUpdatesFromPeerDevice:(id)a0 fromPeerDevice:(id)a1;
- (void)currentPersonalNicknamewithCompletionBlock:(id /* block */)a0;
- (void)evaluateAccountStateForFeatureEligibility;
- (void)_deleteAvatarForNickname:(id)a0;
- (void)getNicknameWithRecordID:(id)a0 decryptionKey:(id)a1 completionBlock:(id /* block */)a2;
- (void)sendPersonalNicknameRecordIDAndVersionRequestedByDevice:(id)a0;
- (void)_newDeviceDidSignIntoiMessageWithRetryCount:(unsigned long long)a0;
- (void)NicknameWithRecordID:(id)a0 URI:(id)a1 decryptionKey:(id)a2 withCompletionBlock:(id /* block */)a3;
- (BOOL)_requestingToSendLocalNicknameInfo:(id)a0;
- (void)loadPersonalNicknameIfNeeded;
- (void)currentPersonalNicknameWithRecordID:(id)a0 decryptionKey:(id)a1 completionBlock:(id /* block */)a2;
- (id)messageDictionaryWithPersonalRecordIDAndVersion;
- (void)sendPersonalNicknameRecordIDAndVersionToAllPeers;
- (void)loadSharingHandlesPrefs;
- (void)_deletePendingNicknameForUpload;
- (void)_updateHandledNicknamesIfNeeded:(id)a0;
- (void)_resetHandleSharingList;
- (void)_markNicknameAsUpdated:(id)a0 incrementPendingNicknameVersion:(BOOL)a1;
- (id)nicknameForHandle:(id)a0;
- (void)sendPendingNicknameUpdatesDidChange;
- (void)markAllNicknamesAsPending;
- (void)saveNicknameForRecordID:(id)a0 handleID:(id)a1 userNickname:(id)a2;
- (id)nicknameForHandleURI:(id)a0;
- (void)_updateWhitelistBlacklistHandlesVersion;
- (void)_tryToReuploadPersonalNicknameWithRetryCount:(unsigned long long)a0 reuploadVersion:(unsigned long long)a1;
- (BOOL)_nicknameFeatureEnabled;
- (id)substringRecordIDForNickname:(id)a0;
- (id)nicknameForRecordID:(id)a0;
- (void)_beginNicknameUpload:(id)a0;
- (void)_storePublicNickname:(id)a0 nicknameLocation:(id)a1 encryptionKey:(id)a2;
- (void)aliasesDidChange:(BOOL)a0;
- (void)whitelistHandlesForSharing:(id)a0 onChatGUIDs:(id)a1;
- (unsigned long long)_reuploadLocalProfileVersionNumber;
- (id)transferServicesController;
- (void)_broadcastPendingMapChanged;
- (void)_markNicknameAsUpdatedForHandleID:(id)a0;
- (id)storedPersonalNickname;
- (void)_updateSharingPreferencesIfNeededFromMadridMessage:(id)a0;
- (void)broadcastHandlesSharingNicknamesDidChange;
- (void)loadHandledNicknamesAndPendingUpdates;
- (void)_deleteNicknameFromPendingMap:(id)a0;
- (void)markNicknameAsUpdated:(id)a0;
- (id)_getPendingNicknameForUpload;
- (id)nickNameRecordID;
- (BOOL)_populateNicknameDictionary:(id)a0 forKVStore:(id)a1 limitToLoad:(unsigned long long)a2;

@end
