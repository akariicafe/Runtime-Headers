@class NSString, NSArray, IDSService, NSSet, NSMutableDictionary, SMSRelayPushHandler, CoreTelephonyClient, NSMutableSet, IMDChatRegistry, IMMultiQueue;

@interface SMSServiceSession : IMDServiceSession <CoreTelephonyClientSMSDelegate, IDSServiceDelegate, IDSAccountRegistrationDelegate, SMSRelayPushHandlerListener> {
    NSMutableDictionary *_outgoingRelayMessageTimerMap;
    NSMutableDictionary *_outgoingMessageMap;
    NSMutableDictionary *_outgoingMessageBlockMap;
    NSMutableDictionary *_outgoingMessageFailureMap;
    IMMultiQueue *_incomingMessageMultiQueue;
    NSMutableDictionary *_spamBlockMap;
    BOOL _isRegistered;
    BOOL _hasClearedMesageQueue;
    IDSService *_relayService;
    IDSService *_smsRelayService;
    IDSService *_smsWatchService;
    NSArray *_currentRelayDevices;
    NSSet *_currentRelayAccounts;
    SMSRelayPushHandler *_smsRelayPushHandler;
    NSMutableSet *_originatedMessages;
    BOOL _pendingOriginatedMessagesTimer;
    NSMutableSet *_pendingRelayApprovalRequests;
    NSMutableDictionary *_pendingCodesToDevicesForApproval;
    CoreTelephonyClient *coreTelephonyClient;
}

@property (retain, nonatomic) IMDChatRegistry *chatRegistry;
@property (readonly) unsigned long long hash;
@property (readonly) Class superclass;
@property (readonly, copy) NSString *description;
@property (readonly, copy) NSString *debugDescription;

- (void)service:(id)a0 activeAccountsChanged:(id)a1;
- (void)enrollDeviceInSMSRelay:(id)a0;
- (id)localDevice;
- (id)idsDeviceFromPushToken:(id)a0;
- (void)unEnrollDeviceInSMSRelay:(id)a0;
- (BOOL)accountHasAlias:(id)a0 aliastoCheck:(id)a1;
- (id)_convertCTMessageToDictionary:(id)a0 requiresUpload:(BOOL *)a1;
- (void)_smsSpamCheck:(id /* block */)a0 withMessageBody:(id)a1 withGuid:(id)a2 sender:(id)a3 shouldRegister:(BOOL)a4;
- (void)handler:(id)a0 incomingPlainTextMessage:(id)a1 toIdentifier:(id)a2 fromIdentifier:(id)a3 timeStamp:(id)a4 storageContext:(id)a5;
- (BOOL)_hasPeerDevices;
- (BOOL)_isDeviceATrustedHSA2Device:(id)a0;
- (id)_getStorageDictionaryUsingMsgDict:(id)a0 requiresUpload:(BOOL)a1;
- (id)createHandleInfoForParticipants:(id)a0 unformattedIDs:(id)a1 countryCodes:(id)a2 isGroupChat:(BOOL)a3;
- (BOOL)_isDefaultPairedDeviceRelayingLocally:(id)a0;
- (id)_convertCTMessagePartToDictionary:(id)a0;
- (void)service:(id)a0 account:(id)a1 identifier:(id)a2 didSendWithSuccess:(BOOL)a3 error:(id)a4;
- (void)mmsMessageReceived:(id)a0 msgID:(long long)a1;
- (void)_messageTimedOut:(id)a0;
- (id)_callerIDUsingFromIdentifier:(id)a0;
- (BOOL)sendApprovalDisplayPinToDevice:(id)a0;
- (BOOL)shouldFixIncomingDate;
- (long long)_numberOfRepliesFor:(id)a0 fallbackFilterCategory:(long long *)a1;
- (void)leaveChat:(id)a0 style:(unsigned char)a1;
- (id)_IDSService;
- (void)_removeDeviceFromChallengedSMSRelay:(id)a0;
- (void)handler:(id)a0 deleteCommand:(id)a1 toIdentifier:(id)a2 fromIdentifier:(id)a3 fromToken:(id)a4 timeStamp:(id)a5 needsDeliveryReceipt:(id)a6 deliveryContext:(id)a7 storageContext:(id)a8;
- (void)sendReadReceiptForMessage:(id)a0 toChatID:(id)a1 identifier:(id)a2 style:(unsigned char)a3;
- (void)_blastDoorProcessingWithIMMessageItem:(id)a0 chat:(id)a1 account:(id)a2 fromToken:(id)a3 fromIDSID:(id)a4 fromIdentifier:(id)a5 toIdentifier:(id)a6 participants:(id)a7 groupName:(id)a8 groupID:(id)a9 isEncrypted:(BOOL)a10 isFromMe:(BOOL)a11 isLastFromStorage:(BOOL)a12 isFromStorage:(BOOL)a13 hideLockScreenNotification:(BOOL)a14 wantsCheckpointing:(BOOL)a15 needsDeliveryReceipt:(id)a16 messageBalloonPayloadAttachmentDictionary:(id)a17 inlineAttachments:(id)a18 attributionInfoArray:(id)a19 nicknameDictionary:(id)a20 messageContext:(id)a21 completionBlock:(id /* block */)a22;
- (id)_getSpamExtensionName;
- (void)handler:(id)a0 localFileRequest:(id)a1 storageContext:(id)a2;
- (BOOL)_checkMMSEnablementForPhoneNumber:(id)a0 simID:(id)a1;
- (void)_removeOriginatedMessage:(id)a0;
- (void)sendPlayedReceiptForMessage:(id)a0 toChatID:(id)a1 identifier:(id)a2 style:(unsigned char)a3;
- (void)handler:(id)a0 localIncomingDownloadMessage:(id)a1 storageContext:(id)a2;
- (id)_challengedDevicesforSMSRelay;
- (void)_enableSMSRelayForDevice:(id)a0;
- (id)_callerIDForRelay;
- (BOOL)_isUsingSMSWatchService;
- (void)_receivedSMSDictionary:(id)a0 requiresUpload:(BOOL)a1 isBeingReplayed:(BOOL)a2;
- (void)handler:(id)a0 incomingDownloadMessage:(id)a1 toIdentifier:(id)a2 fromIdentifier:(id)a3 timeStamp:(id)a4 storageContext:(id)a5;
- (void)_removeDeviceFromAllowedSMSRelay:(id)a0;
- (void)logoutServiceSessionWithAccount:(id)a0;
- (void)handler:(id)a0 messageIDSent:(id)a1 toIdentifier:(id)a2 fromIdentifier:(id)a3 timeStamp:(id)a4 storageContext:(id)a5;
- (void)_processMessageSendFailure:(unsigned int)a0;
- (BOOL)isSMSRelayEnabled;
- (void)service:(id)a0 devicesChanged:(id)a1;
- (void)dealloc;
- (void)handler:(id)a0 localMessageError:(id)a1 storageContext:(id)a2;
- (void)_processMessageSent:(unsigned int)a0;
- (void)handler:(id)a0 localOutgoingDownloadMessage:(id)a1 isBeingReplayed:(BOOL)a2 storageContext:(id)a3;
- (void)refreshServiceCapabilities;
- (void)smsMessageReceived:(id)a0 msgID:(long long)a1;
- (void)scheduleTransactionLogTask:(id)a0;
- (void)_sendMessageToAllSMSRelayDevicesWithOptions:(id)a0;
- (void)sendApprovalResponseToDevice:(id)a0 enteredCorrectly:(BOOL)a1 wasCancelled:(BOOL)a2;
- (id)accountForAlias:(id)a0 fromAccounts:(id)a1;
- (unsigned long long)randomSixDigitCode;
- (void)replayMessage:(id)a0;
- (void)sendDeliveryReceiptForMessageID:(id)a0 toID:(id)a1 deliveryContext:(id)a2 needsDeliveryReceipt:(id)a3 callerID:(id)a4 account:(id)a5;
- (void)_clearSpamMapForMessageGUID:(id)a0;
- (void)handler:(id)a0 localIncommingMessage:(id)a1 storageContext:(id)a2;
- (BOOL)_localDeviceSupportsRelay;
- (BOOL)_hasRelayDevice;
- (id)_callerIDAccountFromSettings;
- (void)_shouldAutoEnableDevicesforSMSRelay:(id /* block */)a0;
- (BOOL)isValidMMS:(id)a0;
- (void)handler:(id)a0 messageIDRead:(id)a1 timeStamp:(id)a2 toIdentifier:(id)a3 fromIdentifier:(id)a4 storageContext:(id)a5;
- (BOOL)isProxyRegistered;
- (id)_allowedIDSDevicesforSMSRelay;
- (void)handler:(id)a0 localOutgoingMessage:(id)a1 isBeingReplayed:(BOOL)a2 storageContext:(id)a3;
- (BOOL)_localDeviceSupportsSMS;
- (BOOL)_isAliasActiveForSMSRelay:(id)a0;
- (void)enqueReplayMessageCallback:(id /* block */)a0;
- (void)_registerForCTNotifications;
- (id)_fixIncomingDate:(id)a0;
- (void)_registerForIncomingMessages:(id)a0;
- (void)sendMessage:(id)a0 toChat:(id)a1 style:(unsigned char)a2;
- (BOOL)_hasPhoneNumberAliasActive;
- (void)handler:(id)a0 localFileResponse:(id)a1 storageContext:(id)a2;
- (id)_messageGUIDForMessageID:(int)a0;
- (id)_createNewChatIdentifierFromChatIdentifier:(id)a0 andCategoryLabel:(id)a1;
- (void)_unregisterForCTNotifications;
- (id)phoneAliasForDominentPhoneAlias:(id)a0 registeredPhoneNumber:(id)a1 preferedCallerID:(id)a2 CTPhoneNumber:(id)a3;
- (void)_addDefaultPairedDeviceToAllowedSMSRelayList;
- (void)_addOriginatedMessage:(id)a0;
- (BOOL)_isValidPhoneNumber:(id)a0 forCountryCode:(id)a1;
- (BOOL)_enableBackwardsCompatibility;
- (BOOL)relayDictionaryToPeers:(id)a0 requiresUpload:(BOOL)a1;
- (id)_convertIMMessageItemToDictionary:(id)a0;
- (id)idsDeviceForFromID:(id)a0;
- (void)_executeSpamCompletionBlockForMessageGuid:(id)a0 category:(long long)a1 shouldRegister:(BOOL)a2;
- (void)postMMSMessageSent:(id)a0 success:(BOOL)a1 messageID:(long long)a2 err1:(long long)a3 err2:(long long)a4;
- (id /* block */)_completionBlockForMessageGUID:(id)a0;
- (BOOL)isIDInList:(id)a0 ArrayToCheck:(id)a1;
- (id)_destinationForDevice:(id)a0 forcedIdentity:(id)a1;
- (void)_checkAndSetRelayService;
- (void)sendApprovalEnrollMe;
- (void)handler:(id)a0 outgoingPlainTextMessage:(id)a1 toIdentifier:(id)a2 fromIdentifier:(id)a3 fromToken:(id)a4 messageGUID:(id)a5 timeStamp:(id)a6 isBeingReplayed:(BOOL)a7 isInProxyMode:(BOOL)a8 storageContext:(id)a9;
- (BOOL)_isConnectedOverBT:(id)a0;
- (unsigned char)_readMMSUserOverrideForSingleSubscription;
- (id)_getSpamExtensionID;
- (void)_registerForAccountChanges;
- (void)_processSMSorMMSMessageReceivedWithContext:(id)a0 messageID:(long long)a1;
- (void)handler:(id)a0 outgoingDownloadMessage:(id)a1 toIdentifier:(id)a2 fromIdentifier:(id)a3 fromToken:(id)a4 messageGUID:(id)a5 timeStamp:(id)a6 isBeingReplayed:(BOOL)a7 storageContext:(id)a8;
- (void)joinChat:(id)a0 handleInfo:(id)a1 style:(unsigned char)a2 groupID:(id)a3 lastAddressedHandle:(id)a4 lastAddressedSIMID:(id)a5 joinProperties:(id)a6;
- (void)_updateLastAddressedIDsIfNeededForChatWithIdentifier:(id)a0 style:(unsigned char)a1 lastAddressedHandle:(id)a2 lastAddressedSIMID:(id)a3;
- (BOOL)sendToLocalPeers:(id)a0;
- (void)invitePersonInfo:(id)a0 withMessage:(id)a1 toChat:(id)a2 style:(unsigned char)a3;
- (void)handler:(id)a0 incomingResponseForApproval:(id)a1 toIdentifier:(id)a2 fromIdentifier:(id)a3 fromToken:(id)a4 messageGUID:(id)a5 timeStamp:(id)a6 storageContext:(id)a7;
- (void)processMessageForSending:(id)a0 toChat:(id)a1 style:(unsigned char)a2 allowWatchdog:(BOOL)a3 completionBlock:(id /* block */)a4;
- (void)_setUpRelay;
- (void)_handleCapabilitiesChanged:(id)a0;
- (void)_updateLastAddressedIDsIfNeededForChatWithIdentifier:(id)a0 style:(unsigned char)a1 lastAddressedHandle:(id)a2 lastAddressedSIMID:(id)a3 iMessageCapability:(long long)a4;
- (id)_challengedIDSDevicesforSMSRelay;
- (id)_ignoredDevicesforSMSRelay;
- (void)_addDeviceToChallengedSMSRelay:(id)a0;
- (void)_updateShouldForceToSMSForChatWithIdentifier:(id)a0 style:(unsigned char)a1 shouldForceToSMS:(BOOL)a2;
- (void)handler:(id)a0 messageIDSendFailure:(id)a1 toIdentifier:(id)a2 fromIdentifier:(id)a3 timeStamp:(id)a4 storageContext:(id)a5;
- (unsigned int)_generateMessageIDForMessageGUID:(id)a0 completionBlock:(id /* block */)a1 failureBlock:(id /* block */)a2;
- (void)_updateCategoryForChat:(id)a0 andMessage:(id)a1 category:(long long)a2 shouldRegister:(BOOL)a3 spamExtensionName:(id)a4;
- (void)_approveSelfForSMSRelay;
- (void)handler:(id)a0 localMessageRead:(id)a1 storageContext:(id)a2;
- (void)joinChat:(id)a0 handleInfo:(id)a1 style:(unsigned char)a2 groupID:(id)a3 joinProperties:(id)a4;
- (id)_convertIMMessageItemDictionaryToIMMessageItem:(id)a0;
- (BOOL)_shouldCheckChatForSMSSpam:(id)a0 shouldRegister:(BOOL)a1 participants:(id)a2 sender:(id)a3 fallbackFilterCategory:(long long *)a4;
- (BOOL)isLocalDeviceProxyRegistered;
- (void)loginServiceSessionWithAccount:(id)a0;
- (BOOL)_shouldUploadToMMCS:(id)a0;
- (id)retrievePhoneAccountAndPhoneAliasFromIDSAccounts:(id)a0;
- (void)_checkIfMessageIsSpam:(id)a0 fromSender:(id)a1 withGuid:(id)a2 shouldRegister:(BOOL)a3;
- (void)_removeDeviceFromIgnoredSMSRelay:(id)a0;
- (BOOL)sendDataToPeers:(id)a0 forcedCallerID:(id)a1 shouldFilterRecepients:(BOOL)a2 requestProxySend:(BOOL)a3 dontSendTo:(id)a4;
- (void)sendDeleteCommand:(id)a0 forChatGUID:(id)a1;
- (id)_ignoredIDSDevicesforSMSRelay;
- (void)_addDeviceToAllowedSMSRelay:(id)a0 shouldSendApproval:(BOOL)a1;
- (void)sessionWillBecomeInactiveWithAccount:(id)a0;
- (unsigned long long)capabilities;
- (void)sendSavedReceiptForMessage:(id)a0 toChatID:(id)a1 identifier:(id)a2 style:(unsigned char)a3;
- (void)_setClearMessageSendTimer;
- (void)_setTimeoutTimerForRelayMessageID:(id)a0 timeout:(double)a1;
- (void)_clearMapForMessageGUID:(id)a0;
- (id)_cleanUnformattedPhoneNumber:(id)a0 countryCode:(id)a1;
- (id)_dominentPhoneNumberAlias;
- (BOOL)_isOneOfMyActiveAlias:(id)a0;
- (BOOL)_syncedMMSEnabledValue;
- (void)_clearPendingIncomingMessageQueue;
- (BOOL)_localDeviceSupportsSMSAndHasAPhoneNumber;
- (void)_handleDeleteCommandWithMessageDictionary:(id)a0;
- (void)_buildCTPhoneNumberWithParticipantInfo:(id)a0 ctMessage:(id)a1;
- (id /* block */)_failureBlockForMessageGUID:(id)a0;
- (id)_allowedDevicesforSMSRelay;
- (void)_addHSA2PairedDevicesToAllowedSMSRelayList;
- (void)handler:(id)a0 outgoingPlainTextMessage:(id)a1 toIdentifier:(id)a2 fromIdentifier:(id)a3 fromToken:(id)a4 messageGUID:(id)a5 timeStamp:(id)a6 isBeingReplayed:(BOOL)a7 storageContext:(id)a8;
- (void)enrollSelfDeviceInSMSRelay;
- (void)sendUnApproveToDevice:(id)a0 extraKeys:(id)a1;
- (id)_myCTPhoneNumber;
- (void)_enqueueBlock:(id /* block */)a0 withTimeout:(double)a1;
- (BOOL)_processReceivedDictionary:(id)a0 storageContext:(id)a1;
- (BOOL)_areAllParticipantsUnknown:(id)a0 fromSender:(id)a1;
- (void)sessionDidBecomeActive;
- (void)_markFromStorageIfNeeded:(id)a0 messageGUID:(id)a1;
- (BOOL)_storeSpamCompletionBlock:(id /* block */)a0 forMessageGUID:(id)a1;
- (void)_updatePhoneNumberCallerID;
- (id)idsDeviceFromUniqueID:(id)a0;
- (void)updateMMSCapability;
- (void)_clearInactivityTimer;
- (BOOL)_isSpamFilteringEnabled;
- (void)handler:(id)a0 incomingEnrollMeRequest:(id)a1 toIdentifier:(id)a2 fromIdentifier:(id)a3 fromToken:(id)a4 messageGUID:(id)a5 timeStamp:(id)a6 storageContext:(id)a7;
- (void)handler:(id)a0 localMessageSent:(id)a1 storageContext:(id)a2;
- (void)joinChat:(id)a0 handleInfo:(id)a1 style:(unsigned char)a2 joinProperties:(id)a3;
- (id)initWithAccount:(id)a0 service:(id)a1;
- (void)_forwardMessageToPeers:(id)a0 messageType:(long long)a1 guid:(id)a2 originalSender:(id)a3;
- (id)_extractSMSSenderAddress:(id)a0;
- (void)_synchronizeMMSCapabilityToWatch:(BOOL)a0;
- (BOOL)_isMessageCategorized:(long long)a0;
- (void)handler:(id)a0 incomingDisplayPinCode:(id)a1 toIdentifier:(id)a2 fromIdentifier:(id)a3 fromToken:(id)a4 messageGUID:(id)a5 timeStamp:(id)a6 storageContext:(id)a7;
- (id)_deviceForCallerID:(id)a0;
- (void)postSMSMessageSent:(id)a0 success:(BOOL)a1 messageID:(long long)a2 err1:(long long)a3 err2:(long long)a4;
- (void)_forwardMessageToPeers:(id)a0 messageType:(long long)a1 guid:(id)a2 originalSender:(id)a3 hasAttachment:(BOOL)a4;
- (id)storageController;
- (BOOL)_areiMessageAndiCloudAccountTheSame:(id)a0;
- (BOOL)sendEnrollmentRelatedMessageOverIDS:(id)a0 deviceToSendTo:(id)a1;
- (void)_processSMSOrSMSMessageSentWithContext:(id)a0 success:(BOOL)a1 messageID:(unsigned int)a2 err1:(long long)a3 err2:(long long)a4 isSMS:(BOOL)a5;
- (void)account:(id)a0 aliasesChanged:(id)a1;
- (void)_clearTimoutTimerForRelayMessageID:(id)a0;
- (void)_updateRelayStatus;
- (id)retrieveAccountAndPhoneAliasForAccounts:(id)a0 shouldFilterRecepients:(BOOL)a1 requestProxySend:(BOOL)a2;
- (void)_addDeviceToIgnoredSMSRelay:(id)a0;
- (BOOL)_localDeviceSupportsSMSAndDoesNotHaveAPhoneNumberForSIMID:(id)a0;
- (void)sendCTMessageFromIMMessageItem:(id)a0 forChat:(id)a1 chat:(id)a2 style:(unsigned char)a3;
- (void)_sendPinCodeToDeviceAndPromptForResponse:(id)a0;

@end
