@class NSURL, PBFPosterSnapshotManager, NSMutableDictionary, NSDate, NSDictionary, NSObject, BSAtomicFlag, PBFComplicationSnapshotService, PBFPosterExtensionDataStoreAssertionManager, PRSwitcherConfiguration, NSString, NSHashTable, NSMutableSet, NSArray, PBFGalleryConfiguration, PRPosterConfiguration, NSNumber, ATXFaceGalleryConfiguration;
@protocol PBFRuntimeAssertionProviding, PBFPosterExtensionProvider, OS_dispatch_queue;

@interface PBFPosterExtensionDataStore : NSObject <PBFPosterExtensionProviderDelegate, PRPosterContentSnapshotProviding, PBFPosterExtensionDataStoreAssertionManagerObserver, PBFBehaviorAssertionObserver, PBFPosterSnapshotManagerObserving, PBFExtensionProviding, BSInvalidatable, PBFBehaviorAssertionProviding> {
    NSURL *_baseURL;
    NSURL *_extensionEnvironmentURL;
    id<PBFRuntimeAssertionProviding> _runtimeAssertionProvider;
    PBFComplicationSnapshotService *_complicationSnapshotService;
    NSHashTable *_observers;
    NSDictionary *_extensionProvidingLock_extensionsByIdentifier;
    ATXFaceGalleryConfiguration *_stateLock_lastUsefulGalleryConfiguration;
    NSDate *_stateLock_lastUsefulGalleryConfigurationPersistDate;
    PBFGalleryConfiguration *_stateLock_configuration;
    ATXFaceGalleryConfiguration *_stateLock_suggestedLayout;
    NSMutableDictionary *_stateLock_extensionStoreCoordinatorForExtensionBundleIdentifier;
    NSMutableDictionary *_stateLock_extensionHandlerForExtensionBundleIdentifier;
    NSMutableDictionary *_stateLock_descriptorsForExtensionBundleIdentifier;
    NSMutableDictionary *_stateLock_staticDescriptorsForExtensionBundleIdentifier;
    PRPosterConfiguration *_stateLock_selectedConfiguration;
    PRSwitcherConfiguration *_stateLock_switcherConfiguration;
    NSArray *_stateLock_configurationUUIDsSorted;
    long long _stateLock_maximumPosterConfigurationCount;
    NSMutableSet *_stateLock_activePathAssertions;
    struct os_unfair_lock_s { unsigned int _os_unfair_lock_opaque; } _extensionProvidingLock;
    struct os_unfair_lock_s { unsigned int _os_unfair_lock_opaque; } _prewarmLock;
    struct os_unfair_lock_s { unsigned int _os_unfair_lock_opaque; } _stateLock;
    NSObject<OS_dispatch_queue> *_notificationQueue;
    NSObject<OS_dispatch_queue> *_galleryRefreshQueue;
    NSObject<OS_dispatch_queue> *_galleryPushQueue;
    NSObject<OS_dispatch_queue> *_clientSnapshotRequestQueue;
    BOOL _stateLock_updatingExtensions;
    BOOL _stateLock_initialExtensionsLoaded;
    NSNumber *_stateLock_hasBeenUnlockedSinceBoot;
    NSNumber *_stateLock_wasMigrationJustPerformed;
    BSAtomicFlag *_extensionsInputIsValidAtomicFlag;
}

@property (class, readonly) long long defaultMaximumPosterConfigurationCount;
@property (class, readonly) long long dataStoreVersion;

@property (readonly, nonatomic) NSURL *extensionStoreCoordinatorContainerURL;
@property (readonly, nonatomic) NSURL *galleryCacheURL;
@property (readonly, nonatomic) NSURL *extensionStoreCoordinatorPurgatoryURL;
@property (readonly, nonatomic) PBFPosterExtensionDataStoreAssertionManager *assertionManager;
@property (readonly, nonatomic) PBFPosterSnapshotManager *snapshotManager;
@property (nonatomic) long long maximumPosterConfigurationCount;
@property (readonly, nonatomic) id<PBFPosterExtensionProvider> extensionProvider;
@property (readonly, nonatomic) NSURL *URL;
@property (readonly, copy, nonatomic) NSArray *knownExtensions;
@property (readonly, copy, nonatomic) NSArray *posterConfigurations;
@property (readonly, copy, nonatomic) PRSwitcherConfiguration *switcherConfiguration;
@property (readonly, nonatomic) BOOL canPersistNewPosterConfiguration;
@property (readonly, nonatomic) PBFGalleryConfiguration *currentGalleryConfiguration;
@property (readonly) unsigned long long hash;
@property (readonly) Class superclass;
@property (readonly, copy) NSString *description;
@property (readonly, copy) NSString *debugDescription;

+ (id)galleryCacheURLForBaseURL:(id)a0;
+ (id)switcherConfigurationOrderingURLForBaseURL:(id)a0 version:(unsigned long long)a1;
+ (id)dataStoreExtensionPurgatoryURLForBaseURL:(id)a0 version:(unsigned long long)a1;
+ (id)_determineActivePosterConfigurationForPosterConfigurationsSortedByUse:(id)a0 activityMode:(id)a1 selectedPosterConfiguration:(id)a2 transitionContext:(id)a3;
+ (id)switcherSelectedConfigurationURLForBaseURL:(id)a0 version:(unsigned long long)a1;
+ (id)dataStoreExtensionContainerURLForBaseURL:(id)a0 version:(unsigned long long)a1;
+ (void)setupDataStoreForBaseURL:(id)a0 version:(unsigned long long)a1 error:(out id *)a2;
+ (long long)dataStoreVersion;
+ (id)dataStoreURLForBaseURL:(id)a0 version:(unsigned long long)a1;
+ (id)dataStoreExtensionContainerURLForBaseURL:(id)a0;
+ (id)galleryCacheURLForBaseURL:(id)a0 version:(unsigned long long)a1;

- (id)_stateLock_activeConfiguration;
- (oneway void)updateGallery:(id)a0 completion:(id /* block */)a1;
- (BOOL)deletePosterConfigurationsMatchingUUID:(id)a0 error:(out id *)a1;
- (void)_setupGalleryEnvironment;
- (id)_stateLock_currentGalleryConfiguration;
- (void)fetchPosterSnapshotsForRequest:(id)a0 completion:(id /* block */)a1;
- (void)assertionManager:(id)a0 pathIsNowMarkedAsNOTInUse:(id)a1;
- (id)updateDataStoreForSwitcherConfiguration:(id)a0 options:(unsigned long long)a1 reason:(id)a2 error:(out id *)a3;
- (id)_stateLock_descriptorStoreCoordinatorForIdentifier:(id)a0 extensionStoreCoordinator:(id)a1 createIfNil:(BOOL)a2 error:(out id *)a3;
- (id)_stateLock_initializeEmptySwitcherConfiguration;
- (void)_stateLock_findStoreCoordinatorsForUUID:(id)a0 extensionStoreCoordinator:(out id *)a1 configurationStoreCoordinator:(out id *)a2;
- (id)dataFreshnessForComponents:(id)a0;
- (void)_setupExtensionEnvironment;
- (void)refreshSnapshotForPosterConfigurationMatchUUID:(id)a0 completion:(id /* block */)a1;
- (void)overnightUpdateWithCompletion:(id /* block */)a0;
- (void)_stateLock_applyUpdates:(id)a0 toPath:(id)a1 powerLogReason:(long long)a2 completion:(id /* block */)a3;
- (id)_stateLock_buildSwitcherConfigurationWithContext:(id)a0 outMutated:(out BOOL *)a1;
- (BOOL)_ingestReloadedDescriptorsForExtensionBundleIdentifier:(id)a0 preReloadDescriptors:(id)a1 postReloadDescriptors:(id)a2 error:(out id *)a3;
- (void)_stateLock_transitionToNewSwitcherConfigurationIfNeeded:(id)a0 reason:(id)a1 error:(out id *)a2;
- (void)_stateLock_loadPersistedGalleryConfigurationWithLastUpdateDate:(out id *)a0 error:(out id *)a1;
- (void)_stateLock_pushPosterDescriptorsToProactiveForReason:(id)a0 completion:(id /* block */)a1;
- (id)posterDescriptorsForExtensionBundleIdentifier:(id)a0 error:(out id *)a1;
- (void)refreshSnapshotForGalleryItemsMatchingDescriptorIdentifier:(id)a0 extensionIdentifier:(id)a1 completion:(id /* block */)a2;
- (id)buildExtensionProvider;
- (void)addObserver:(id)a0;
- (id)_stateLock_lastUseDatesForPosterConfigurations;
- (void)executeUpdate:(id)a0 refreshStrategy:(long long)a1 galleryUpdateOptions:(unsigned long long)a2 powerLogReason:(long long)a3 completion:(id /* block */)a4;
- (id)_stateLock_extensionForExtensionBundleIdentifier:(id)a0;
- (void)_notifyObserversDidUpdateConfiguration:(id)a0 homeScreenAssociatedConfiguration:(id)a1;
- (id)_stateLock_posterConfigurationOrdering;
- (void)importPosterConfigurationFromArchiveData:(id)a0 completion:(id /* block */)a1;
- (void)updatePosterConfigurationMatchingUUID:(id)a0 updates:(id)a1 completion:(id /* block */)a2;
- (void)_stateLock_setupSwitcherConfigurationForFirstTime;
- (id)initWithURL:(id)a0 runtimeAssertionProvider:(id)a1 extensionProvider:(id)a2 observer:(id)a3 wasMigrationJustPerformed:(BOOL)a4 error:(out id *)a5;
- (id)_stateLock_fetchPosterConfigurations;
- (id)_stateLock_ingestPosterConfiguration:(id)a0 fromIdentity:(id)a1 parentIdentity:(id)a2 amalgamatedConfiguredProperties:(id)a3 options:(unsigned long long)a4 powerLogReason:(long long)a5 error:(out id *)a6;
- (long long)maximumPosterConfigurationCount;
- (void)_transitionToNewSwitcherConfigurationIfNeeded:(id)a0 reason:(id)a1 error:(out id *)a2;
- (id)_stateLock_knownExtensionIdentifiers;
- (long long)_stateLock_maximumPosterConfigurationCount;
- (void)_stateLock_pushPosterConfigurationsToProactiveWithCompletion:(id /* block */)a0;
- (void)_notifyObserversDidUpdateSwitcherConfiguration:(id)a0;
- (void)_notifyObserversDidDeleteConfiguration:(id)a0;
- (BOOL)_stateLock_updateEnvironmentForExtension:(id)a0 error:(out id *)a1;
- (void)_notifyObserversDidUpdateActiveConfiguration:(id)a0 associatedConfiguration:(id)a1;
- (void)enumerateExtensionStoreCoordinators:(id /* block */)a0;
- (void)checkForGalleryUpdates;
- (void)_stateLock_enqueueRefreshPosterConfigurationMatchingUUID:(id)a0 sessionInfo:(id)a1 powerLogReason:(long long)a2 completion:(id /* block */)a3;
- (id)_stateLock_fetchPosterConfigurationsSortedByUse:(BOOL)a0;
- (void)fetchPosterSuggestionsForFocusModeWithUUID:(id)a0 completion:(id /* block */)a1;
- (id)_stateLock_extensionStoreCoordinatorForExtensionBundleIdentifier:(id)a0;
- (void)_stateLock_updateSnapshotsForSwitcherConfigurationWithIntention:(unsigned long long)a0 powerLogReason:(long long)a1 completion:(id /* block */)a2;
- (void)_notifyObserversDidUpdateConfiguration:(id)a0;
- (id)posterDescriptorsForOperation:(id)a0;
- (void)createPosterConfigurationForProviderIdentifier:(id)a0 posterDescriptorIdentifier:(id)a1 completion:(id /* block */)a2;
- (void)_notifyObserversDidUpdatePosterDescriptorsForExtensionBundleIdentifier:(id)a0;
- (BOOL)_stateLock_hasBeenUnlockedSinceBoot;
- (id)_stateLock_homeScreenPosterConfigurationForPosterConfigurations;
- (void)fetchSnapshotForConfiguration:(id)a0 compatibleWithTraitCollection:(id)a1 completion:(id /* block */)a2;
- (void)fetchGallerySnapshotForConfiguration:(id)a0 completion:(id /* block */)a1;
- (void)_stateLock_pushPosterConfigurationOrdering:(id)a0;
- (void)_notifyObserversDidInitializeWithSwitcherConfiguration:(id)a0 withChanges:(BOOL)a1;
- (id)exportPosterConfigurationMatchingUUID:(id)a0 error:(out id *)a1;
- (void)reloadPosterDescriptorsForExtensionBundleIdentifier:(id)a0 sessionInfo:(id)a1 completion:(id /* block */)a2;
- (void)_notifyObserversDidUpdateConfigurations;
- (BOOL)_stateLock_setupEnvironmentForExtension:(id)a0 wasUpdated:(out BOOL *)a1 error:(out id *)a2;
- (void)_pushFaceGalleryConfigurationUpdate:(id)a0 options:(unsigned long long)a1 fetchError:(id)a2 completion:(id /* block */)a3;
- (void)fetchPosterSnapshotsWithClientRequest:(id)a0 completion:(id /* block */)a1;
- (void)_stateLock_transitionToNewSwitcherConfigurationAfterAddedExtensions:(id)a0 deletedExtensions:(id)a1 error:(out id *)a2;
- (void)_stateLock_enqueueGalleryConfigurationUpdateWithOptions:(unsigned long long)a0 powerLogReason:(long long)a1 completion:(id /* block */)a2;
- (void)_stateLock_createTemporaryPosterConfigurationForPosterMatchingUUID:(id)a0 andApplyUpdates:(id)a1 completion:(id /* block */)a2;
- (id)_stateLock_enqueueReloadDescriptorsOperationForExtensionBundleIdentifier:(id)a0 reason:(id)a1 powerLogReason:(long long)a2 postEnqueueGalleryUpdateOptions:(unsigned long long)a3 sessionInfo:(id)a4 completion:(id /* block */)a5;
- (void)removeObserver:(id)a0;
- (void)setMaximumPosterConfigurationCount:(long long)a0;
- (id)_stateLock_switcherConfiguration;
- (void)snapshotManager:(id)a0 didUpdateSnapshotForPath:(id)a1 forDefinition:(id)a2;
- (void)_stateLock_updateExtensions:(id)a0 refreshDescriptors:(long long)a1 powerLogReason:(long long)a2 galleryUpdateOptions:(unsigned long long)a3 queuedUpOperations:(out id *)a4;
- (id)_stateLock_selectedConfiguration;
- (void)updateFocusModeForActivePosterChange;
- (void)pushPosterDescriptorsToProactiveForReason:(id)a0 completion:(id /* block */)a1;
- (void)_stateLock_updateGalleryWithSuggestedLayout:(id)a0 descriptorsByExtensionBundleIdentifier:(id)a1 staticDescriptorsByExtensionBundleIdentifier:(id)a2 extensionsByIdentifier:(id)a3;
- (BOOL)_stateLock_canPersistNewPosterConfiguration;
- (void)removeBehaviorAssertionObserver:(id)a0;
- (id)_stateLock_updateDataStoreForSwitcherConfiguration:(id)a0 options:(unsigned long long)a1 reason:(id)a2 error:(out id *)a3;
- (id)_stateLock_createPosterConfigurationForProviderIdentifier:(id)a0 posterDescriptorIdentifier:(id)a1 error:(out id *)a2;
- (BOOL)_stateLock_persistGalleryConfiguration:(id)a0 lastUpdateDate:(out id *)a1 error:(out id *)a2;
- (void)fetchHomeScreenAssociatedPosterConfigurationForConfigurationUUID:(id)a0 completion:(id /* block */)a1;
- (id)updateDataStoreForIncomingFocusModeChange:(id)a0 error:(out id *)a1;
- (BOOL)_stateLock_deletePosterConfigurationsMatchingUUID:(id)a0 error:(out id *)a1;
- (id)_stateLock_extensionBundleIdentifierForConfigurationUUID:(id)a0;
- (void)_finishUpdateExtensionUpdateWithOptions:(unsigned long long)a0 updateExtensionSession:(id)a1 pushToProactiveError:(id)a2 runtimeAssertion:(id)a3;
- (id)activeEditingSessionAssertionExtensionIdentifiers;
- (id)staticPosterDescriptorsForExtensionBundleIdentifier:(id)a0 error:(out id *)a1;
- (void)refreshPosterConfigurationMatchingUUID:(id)a0 sessionInfo:(id)a1 completion:(id /* block */)a2;
- (void)pushToProactiveWithCompletion:(id /* block */)a0;
- (void)assertionManager:(id)a0 pathIsNowMarkedInUse:(id)a1;
- (void)posterExtensionProvider:(id)a0 foundExtensions:(id)a1;
- (id)_stateLock_knownExtensions;
- (id)_stateLock_prepareReloadConfigurationOperationForExtension:(id)a0 path:(id)a1 locationInUse:(BOOL)a2 sessionInfo:(id)a3 powerLogReason:(long long)a4 error:(out id *)a5;
- (void)_setupExtensionProvider;
- (id)acquireSnapshotterInUseAssertionWithReason:(id)a0;
- (void)_notifyObserversDidUpdateSelectedConfiguration:(id)a0 associatedConfiguration:(id)a1;
- (void)_stateLock_cullDataForInvalidExtensions;
- (oneway void)fetchGalleryConfigurationWithOptions:(unsigned long long)a0 completion:(id /* block */)a1;
- (void)_notifyObserversDidUpdateExtensions;
- (void)_notifyObserversDidUpdateGalleryConfiguration:(id)a0;
- (id)_stateLock_posterConfigurationPathForUUID:(id)a0;
- (id)providerForExtensionIdentifier:(id)a0;
- (void)_stateLock_enumerateConfigurationStoreCoordinators:(id /* block */)a0;
- (id)providerForPath:(id)a0;
- (void)_ingestRefreshPosterConfiguration:(id)a0 completion:(id /* block */)a1;
- (void)_stateLock_persistSelectedConfigurationIdentifier:(id)a0;
- (void)invalidate;
- (void)createTemporaryPosterConfigurationForPosterMatchingUUID:(id)a0 andApplyUpdates:(id)a1 completion:(id /* block */)a2;
- (id)_stateLock_deletePosterDescriptorsForExtensionBundleIdentifier:(id)a0;
- (void)_stateLock_applyUpdatesAndIngestConfiguration:(id)a0 toPath:(id)a1 powerLogReason:(long long)a2 completion:(id /* block */)a3;
- (void)_stateLock_updateFocusModeForActivePosterChange;
- (BOOL)_stateLock_cleanupAfterDeletedExtension:(id)a0 error:(out id *)a1;
- (id)_stateLock_knownStaticPosterDescriptorsForExtensionBundleIdentifier:(id)a0;
- (id)dataFreshnessForComponents:(id)a0 refreshStrategy:(long long)a1;
- (void)addBehaviorAssertionObserver:(id)a0;
- (BOOL)deletePosterDescriptorsForExtensionBundleIdentifier:(id)a0 error:(out id *)a1;
- (void)prewarmWithCompletion:(id /* block */)a0;
- (BOOL)_stateLock_updateDescriptorsFromStaticDescriptorsForExtensionBundleIdentifier:(id)a0 reason:(long long)a1 error:(out id *)a2;
- (void)updateSnapshotsForGallery:(id)a0 intention:(unsigned long long)a1 powerLogReason:(long long)a2 completion:(id /* block */)a3;
- (void)_notifyObserversDidUpdateSnapshotForConfiguration:(id)a0;
- (void)_stateLock_enumerateExtensionStoreCoordinators:(id /* block */)a0;
- (id)_stateLock_knownPosterDescriptorsForExtensionBundleIdentifier:(id)a0;
- (id)acquireEditingSessionAssertionForProvider:(id)a0 withReason:(id)a1;
- (void).cxx_destruct;
- (id)updateDataStoreForSwitcherConfiguration:(id)a0 reason:(id)a1 error:(out id *)a2;
- (void)_stateLock_fetchPosterSnapshotsWithClientRequest:(id)a0 completion:(id /* block */)a1;
- (void)enqueueGalleryConfigurationUpdateWithOptions:(unsigned long long)a0 powerLogReason:(long long)a1 completion:(id /* block */)a2;
- (void)_stateLock_updatePosterConfigurationMatchingUUID:(id)a0 updates:(id)a1 completion:(id /* block */)a2;
- (id)acquireSnapshotterDisabledAssertionForProvider:(id)a0 withReason:(id)a1;
- (void)_notifyObserversDidAddConfiguration:(id)a0;
- (void)ingestSnapshotCollection:(id)a0 forPosterConfigurationUUID:(id)a1 error:(out id *)a2;
- (id)ingestIncomingPosterConfiguration:(id)a0 options:(unsigned long long)a1 error:(out id *)a2;

@end
