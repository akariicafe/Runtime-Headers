@class NSURL, CPLEngineScopeCleanupTasks, CPLEngineQuarantinedRecords, CPLChangeBatch, CPLEngineInitialQueryTracker, CPLResetTracker, NSMutableArray, NSString, CPLEngineRemappedDeletes, CPLEngineChangePipe, CPLEngineCloudCache, NSArray, CPLEngineIDMapping, NSMutableDictionary, NSObject, NSSet, CPLSyncSessionPredictor, CPLEngineScopeStorage, CPLEngineTransientRepository, CPLEngineDerivativesCache, CPLEngineLibrary, CPLEngineResourceStorage, CPLEngineStatusCenter, CPLEngineOutgoingResources, CPLPlatformObject, CPLEnginePushRepository, NSDate, CPLRecordStorageView, CPLEngineResourceDownloadQueue, NSHashTable;
@protocol OS_dispatch_queue, OS_dispatch_source;

@interface CPLEngineStore : NSObject <CPLAbstractObject, CPLEngineComponent> {
    NSHashTable *_storages;
    NSObject<OS_dispatch_queue> *_batchedTransactionsQueue;
    NSMutableArray *_batchedTransactions;
    BOOL _batchedTransactionDequeueIsScheduled;
    BOOL _dontDelayChangeSessionUpdate;
    BOOL _applyingChangeSessionUpdate;
    NSURL *_resetEventsURL;
    NSMutableArray *_resetEvents;
    CPLResetTracker *_pendingTracker;
    CPLChangeBatch *_unacknowledgedBatch;
    BOOL _discardUnacknowledgedBatchOnTransactionFail;
    BOOL _transactionClientCacheViewHasPushRepository;
    NSMutableDictionary *_transactionNewPredictions;
    NSSet *_lastInvalidRecordScopedIdentifiers;
    NSDate *_lastInvalidRecordsDate;
    NSObject<OS_dispatch_source> *_pendingUpdateTimer;
    NSObject<OS_dispatch_queue> *_pendingUpdateQueue;
    double _pendingUpdateInterval;
    BOOL _unschedulePendingUpdateApplyOnWriteSuccess;
    BOOL _schedulePendingUpdateApplyOnWriteSuccess;
    BOOL _scheduleSetupOnWriteSuccess;
    BOOL _scheduleDisabledFeatureUpdateOnWriteSuccess;
    BOOL _schedulePullFromClient;
    NSObject<OS_dispatch_queue> *_shouldSyncScopeListQueue;
    BOOL _shouldEnableScopeListSyncOnWriteSuccess;
    NSArray *_disabledFeatures;
    BOOL _hasUpdatedDisabledFeatures;
    BOOL _isUpdatingDisabledFeatures;
    BOOL _shouldTriggerCompleteResetSyncAfterDisabledFeaturesUpdate;
    BOOL _shouldTriggerResetSyncAfterDisabledFeaturesUpdate;
}

@property (class, readonly, nonatomic) NSArray *storageNames;

@property (readonly, nonatomic) BOOL hasPendingResetSync;
@property (nonatomic) unsigned long long state;
@property (readonly, nonatomic) NSArray *storages;
@property (readonly, weak, nonatomic) CPLEngineLibrary *engineLibrary;
@property (readonly) BOOL shouldSyncScopeList;
@property (readonly, nonatomic) CPLEnginePushRepository *pushRepository;
@property (readonly, nonatomic) BOOL pushRepositoryIsFull;
@property (readonly, nonatomic) CPLEngineScopeStorage *scopes;
@property (readonly, nonatomic) CPLEngineScopeCleanupTasks *cleanupTasks;
@property (readonly, nonatomic) CPLEngineChangePipe *pullQueue;
@property (readonly, nonatomic) CPLEngineIDMapping *idMapping;
@property (readonly, nonatomic) CPLEngineCloudCache *cloudCache;
@property (readonly, nonatomic) CPLRecordStorageView *transactionClientCacheView;
@property (readonly, nonatomic) CPLEngineTransientRepository *transientPullRepository;
@property (readonly, nonatomic) CPLEngineResourceStorage *resourceStorage;
@property (readonly, nonatomic) CPLEngineResourceDownloadQueue *downloadQueue;
@property (readonly, nonatomic) CPLEngineOutgoingResources *outgoingResources;
@property (readonly, nonatomic) CPLEngineRemappedDeletes *remappedDeletes;
@property (readonly, nonatomic) CPLEngineQuarantinedRecords *quarantinedRecords;
@property (readonly, nonatomic) CPLEngineStatusCenter *statusCenter;
@property (readonly, nonatomic) CPLEngineInitialQueryTracker *initialQueryTracker;
@property (readonly) NSDate *libraryCreationDate;
@property (readonly, nonatomic) id corruptionInfo;
@property (readonly, nonatomic) CPLEngineDerivativesCache *derivativesCache;
@property (readonly, nonatomic) BOOL shouldGenerateDerivatives;
@property (readonly, nonatomic) NSArray *disabledFeatures;
@property (readonly, nonatomic) BOOL shouldUpdateDisabledFeatures;
@property (readonly, nonatomic) CPLSyncSessionPredictor *predictor;
@property (readonly, nonatomic) CPLPlatformObject *platformObject;
@property (readonly) unsigned long long hash;
@property (readonly) Class superclass;
@property (readonly, copy) NSString *description;
@property (readonly, copy) NSString *debugDescription;

+ (id)platformImplementationProtocol;
+ (id)stateDescriptionForState:(unsigned long long)a0;

- (id)performReadTransactionWithBlock:(id /* block */)a0;
- (void)writeTransactionDidSucceed;
- (void)writeTransactionDidFail;
- (void)performBatchedWriteTransactionBarrierWithCompletionBlock:(id /* block */)a0;
- (void)openWithCompletionHandler:(id /* block */)a0;
- (BOOL)hasPendingChangeSessionUpdate;
- (id)userIdentifier;
- (BOOL)deleteDynamicallyCreatedStorages:(id)a0 error:(id *)a1;
- (void)testKey:(id)a0 value:(id)a1 completionHandler:(id /* block */)a2;
- (id)clientCacheIdentifier;
- (BOOL)resetLocalSyncStateWithCause:(id)a0 error:(id *)a1;
- (id)unacknowledgedChangeWithLocalScopedIdentifier:(id)a0;
- (id)_storedDisabledFeatures;
- (BOOL)resetSyncAnchorWithCause:(id)a0 error:(id *)a1;
- (id)initWithEngineLibrary:(id)a0;
- (BOOL)storeClientIsInSyncWithClientCacheWithError:(id *)a0;
- (void)_setTransactionOnCurrentThread:(id)a0;
- (void)transactionDidFinish;
- (id)_resetEventsDescriptions;
- (id)_currentTransaction;
- (void)_reallyUnschedulePendingUpdateApply;
- (void)_storeResetEvent:(id)a0 scopeIdentifier:(id)a1 date:(id)a2 pending:(BOOL)a3 cause:(id)a4;
- (id)lastQuarantineCountReportDate;
- (BOOL)_canWrite;
- (void)_performBarrierTransaction:(id)a0 withBlock:(id /* block */)a1;
- (BOOL)resetCompleteSyncStateIncludingIDMappingWithCause:(id)a0 error:(id *)a1;
- (id)_performWriteTransactionByPassBlocker:(id)a0 WithBlock:(id /* block */)a1 completionHandler:(id /* block */)a2;
- (BOOL)hasUnacknowledgedChanges;
- (void)_loadResetEvents;
- (BOOL)resetLocalSyncStateWithCause:(id)a0 date:(id)a1 error:(id *)a2;
- (void)performBarrier;
- (void)getStatusDictionaryWithCompletionHandler:(id /* block */)a0;
- (BOOL)storeLastQuarantineCountReportDate:(id)a0 error:(id *)a1;
- (void)_addCleanupBlock:(id /* block */)a0;
- (void)_storeResetEvent:(id)a0 scopeIdentifier:(id)a1 date:(id)a2 cause:(id)a3;
- (void)performBatchedWriteTransactionBarrier;
- (void)assertCanRead;
- (BOOL)storeDerivativesFilter:(id)a0 error:(id *)a1;
- (void)registerStorage:(id)a0;
- (BOOL)_applyAndDiscardPendingUpdate:(id)a0 error:(id *)a1;
- (void)_removeTransactionOnCurrentThread:(id)a0;
- (void)_unschedulePendingUpdateApply;
- (id)newClientCacheViewUsesPushRepository:(BOOL *)a0;
- (BOOL)isFeatureDisabled:(id)a0;
- (id)_resetEventsJSON;
- (BOOL)_resetCompleteSyncStateWithCause:(id)a0 scope:(id)a1 error:(id *)a2;
- (unsigned long long)libraryOptions;
- (BOOL)_shouldSyncScopeListWithOptions:(unsigned long long)a0;
- (id)derivativesFilter;
- (void)noteOtherResetEvent:(id)a0 cause:(id)a1;
- (void)getStatusWithCompletionHandler:(id /* block */)a0;
- (void)_performTransaction:(id)a0 withBlock:(id /* block */)a1;
- (BOOL)checkExpectedLibraryVersion:(id)a0 error:(id *)a1;
- (void).cxx_destruct;
- (BOOL)beginChangeSession:(id)a0 withLibraryVersion:(id)a1 resetTracker:(id)a2 error:(id *)a3;
- (BOOL)resetCompleteSyncStateWithCause:(id)a0 error:(id *)a1;
- (void)_dropTransactionClientCacheView;
- (void)performBatchedWriteTransactionWithBlock:(id /* block */)a0 completionHandler:(id /* block */)a1;
- (BOOL)_resetCompleteSyncStateIncludingIDMappingWithCause:(id)a0 scope:(id)a1 error:(id *)a2;
- (BOOL)applyPreviousChangeSessionUpdateWithExpectedLibraryVersion:(id)a0 error:(id *)a1;
- (BOOL)updateLibraryOptions:(unsigned long long)a0 error:(id *)a1;
- (BOOL)_handleException:(id)a0;
- (void)stopVacuum;
- (void)startVacuum;
- (BOOL)storeLibraryVersion:(id)a0 withError:(id *)a1;
- (BOOL)_applyPendingUpdate:(id)a0 error:(id *)a1;
- (id)performWriteTransactionByPassBlocker:(id)a0 withBlock:(id /* block */)a1 completionHandler:(id /* block */)a2;
- (void)markAsCorrupted;
- (id)performWriteTransactionWithBlock:(id /* block */)a0 completionHandler:(id /* block */)a1;
- (void)emergencyClose;
- (id)componentName;
- (void)predictSyncSessionValue:(id)a0 ofType:(id)a1;
- (BOOL)setShouldUpdateDisabledFeaturesWithError:(id *)a0;
- (BOOL)isClientInSyncWithClientCache;
- (void)assertNoUnacknowledgedChanges;
- (void)_updateShouldSyncScopeList:(BOOL)a0;
- (BOOL)storeUserIdentifier:(id)a0 error:(id *)a1;
- (void)blockWriteTransactionsWithCompletionHandler:(id /* block */)a0;
- (BOOL)_canRead;
- (BOOL)_resetGlobalStateWithError:(id *)a0;
- (id)createNewLibraryVersion;
- (BOOL)updateDisabledFeatures:(id)a0 didReset:(BOOL *)a1 error:(id *)a2;
- (void)_reallySchedulePendingUpdateApply;
- (void)_scheduleBatchedTransactionsLocked;
- (BOOL)createStoragesDynamically:(id)a0 error:(id *)a1;
- (void)dealloc;
- (void)_commitWriteTransaction:(id)a0 commitError:(id)a1;
- (void)noteInvalidRecordScopedIdentifiersInPushSession:(id)a0;
- (void)keepUnacknowledgedBatch:(id)a0;
- (BOOL)_resetSyncAnchorWithCause:(id)a0 scope:(id)a1 error:(id *)a2;
- (id)localResourceForCloudResource:(id)a0 recordClass:(Class *)a1;
- (id)libraryVersion;
- (void)noteResetSyncFinished;
- (void)_reallyPerformBatchedTransactionsLocked;
- (void)closeAndDeactivate:(BOOL)a0 completionHandler:(id /* block */)a1;
- (BOOL)storeChangeSessionUpdate:(id)a0 error:(id *)a1;
- (BOOL)_storeChangeSessionUpdate:(id)a0 error:(id *)a1;
- (void)dropUnacknowledgedBatch;
- (BOOL)forceApplyPendingChangeSessionUpdateWithError:(id *)a0;
- (void)notePushRepositoryStoredSomeChanges;
- (void)_finishTransaction;
- (void)_schedulePendingUpdateApply;
- (void)assertCanWrite;
- (void)wipeStoreAtNextOpeningWithReason:(id)a0 completionBlock:(id /* block */)a1;
- (BOOL)_resetLocalSyncStateWithCause:(id)a0 scope:(id)a1 date:(id)a2 error:(id *)a3;

@end
