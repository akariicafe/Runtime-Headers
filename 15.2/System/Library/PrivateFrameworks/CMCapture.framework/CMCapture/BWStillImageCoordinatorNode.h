@class NSString, BWFigVideoCaptureDevice, FigStateMachine, FigCaptureStillImageSettings, NSMutableDictionary, NSDictionary, BWStillImageCaptureSettings, NSObject, NSMutableArray, BWStillImageProcessingSettings;
@protocol BWStillImageCaptureStatusDelegate, OS_dispatch_group, OS_dispatch_queue, BWStillImageProcessingSupportProvider;

@interface BWStillImageCoordinatorNode : BWNode <BWFigVideoCaptureStreamStillImageCaptureDelegate, BWStillImageProcessingStatusDelegate> {
    BOOL _active;
    BWFigVideoCaptureDevice *_captureDevice;
    NSDictionary *_portTypeToInput;
    NSDictionary *_portTypeToOutput;
    int _stillImageCapturePipeliningMode;
    unsigned int _numberOfBurstCapturesInFlight;
    unsigned int _maxNumberOfBurstCapturesAllowedInFlight;
    BOOL _alwaysRequestsPreBracketedEV0;
    BOOL _usesHDRPreBracketFrameForErrorRecovery;
    BOOL _supportsCalibrationWithoutDepthForBravoConstituentPhoto;
    NSMutableArray *_requestQueue;
    struct os_unfair_lock_s { unsigned int _os_unfair_lock_opaque; } _requestQueueLock;
    int _captureRequestCount;
    int _prepareRequestCount;
    NSObject<OS_dispatch_queue> *_stillImageDispatchQueue;
    NSObject<OS_dispatch_group> *_stillImageDispatchGroup;
    NSObject<OS_dispatch_group> *_stillImageGraphStopDispatchGroup;
    FigStateMachine *_stateMachine;
    NSMutableDictionary *_receivedImagesOrErrorsForRequestByPortType;
    int _clientExpectedImagesOrErrorsForRequest;
    int _clientReceivedImagesOrErrorsForRequest;
    FigCaptureStillImageSettings *_currentRequestedStillImageCaptureSettings;
    int _captureType;
    BWStillImageCaptureSettings *_currentResolvedStillImageCaptureSettings;
    BWStillImageProcessingSettings *_currentResolvedStillImageProcessingSettings;
    unsigned int _firedDelegateCallbackFlags;
    BOOL _isMomentCaptureCapturingBeforeCommitted;
    NSMutableArray *_momentCaptureUnfiredCallbacks;
    NSMutableArray *_momentCaptureBuffersByInputIndex;
    int _momentCaptureUncommittedStillImageCaptureError;
    long long _momentCaptureUnfiredWillBeginCaptureBeforeResolvingSettingsCallbackSettingsID;
    long long _momentCaptureLastComittedSettingsID;
    struct { long long value; int timescale; unsigned int flags; long long epoch; } _streamingDisruptionEndPTS;
    BOOL _receivedQuadraHighResError;
    struct os_unfair_lock_s { unsigned int _os_unfair_lock_opaque; } _bufferTrackingLock;
    int _inUseBufferCount;
    BOOL _responsiveShutterEnabled;
    BOOL _fastCapturePrioritizationEnabled;
    BOOL _shotBufferEnabled;
    int _allocatedShotBufferCapacity;
    NSObject<OS_dispatch_group> *_shotBufferWaitGroup;
    int _shotBufferWaitFreeBufferCount;
    BOOL _shotPacerEnabled;
    float _shotPacerMaxFPS;
    long long _lastStillImageCaptureStartTime;
    long long _lastStillImageCaptureCompleteTime;
    BOOL _dynamicShotQualityEnabled;
    int _minFullQualityShots;
    float _timeSinceLastCaptureEnterThreshold;
    float _timeSinceLastCaptureExitThreshold;
    int _numCapturesInShotSequence;
    BOOL _waitForTimeMachineEnabled;
}

@property (class) int maxShotBufferCapacity;
@property (class) int currentAllocatedShotBufferCapacity;

@property (nonatomic) id<BWStillImageCaptureStatusDelegate> stillImageCaptureStatusDelegate;
@property (nonatomic) id<BWStillImageProcessingSupportProvider> stillImageProcessingSupportProvider;
@property (readonly) unsigned long long hash;
@property (readonly) Class superclass;
@property (readonly, copy) NSString *description;
@property (readonly, copy) NSString *debugDescription;

+ (void)initialize;
+ (id)stringForStillImageCapturePipeliningMode:(int)a0;
+ (int)worstCaseMaxBracketedCaptureBufferCountForPreparedSettings:(id)a0 captureDevice:(id)a1;

- (id)_clientBracketSettingsWithFrameStatisticsByPortType:(id)a0;
- (void)setAlwaysRequestsPreBracketedEV0:(BOOL)a0;
- (void)handleNodeError:(id)a0 forInput:(id)a1;
- (void)configurationWithID:(long long)a0 updatedFormat:(id)a1 didBecomeLiveForInput:(id)a2;
- (int)_captureTypeForSettings:(id)a0 frameStatisticsByPortType:(id)a1 captureFlags:(unsigned long long *)a2;
- (id)nodeSubType;
- (id)_currentStillImageSettings;
- (int)prepareStillImageCaptureNowWithSettings:(id)a0;
- (void)_addAttachmentsToSampleBuffer:(struct opaqueCMSampleBuffer { } *)a0;
- (void)clientReceivedPayloadForSettings:(id)a0 status:(int)a1 clientIsMidStillImageGraph:(BOOL)a2;
- (void)_completeRequestWithStatus:(int)a0;
- (void)_didResolveReferenceFrameBracketedCaptureSequenceNumber:(id)a0;
- (void)_beginResolvingCapture;
- (id)_stateMachine;
- (void)_fireDelegateCallbackWithInfo:(id)a0;
- (void)_updateResponsiveShutterEnabled;
- (void)_waitToMakePaceWithReferenceTime:(long long)a0;
- (BOOL)fastCapturePrioritizationEnabled;
- (void)_renderSampleBuffer:(struct opaqueCMSampleBuffer { } *)a0 forInput:(id)a1 attemptToCompleteRequest:(BOOL)a2;
- (void)didReachEndOfDataForInput:(id)a0;
- (void)_didCaptureStillImage;
- (id)_resolvePhotoManifest;
- (void)setMaxNumberOfBurstCapturesAllowedInFlight:(unsigned int)a0;
- (void)_didSelectNewReferenceFrameWithPTS:(struct { long long x0; int x1; unsigned int x2; long long x3; })a0 transform:(id)a1;
- (void)setSupportsCameraCalibrationDataWithoutDepthForBravoConstituentPhoto:(BOOL)a0;
- (id)outputForPortType:(id)a0;
- (id)nodeType;
- (void)node:(id)a0 didSelectNewReferenceFrameWithPTS:(struct { long long x0; int x1; unsigned int x2; long long x3; })a1 transform:(id)a2;
- (BOOL)_waitUntilShotBufferHasFreeBufferCount:(int)a0 timeout:(float)a1;
- (void)prepareForCurrentConfigurationToBecomeLive;
- (void)_fireDelegateCallbackWithFlag:(unsigned int)a0;
- (int)cancelStillImageMomentCaptureWithSettingsID:(long long)a0;
- (int)captureStillImageNowWithSettings:(id)a0;
- (void)_setupProcessing;
- (id)_outputForInput:(id)a0;
- (BOOL)responsiveShutterEnabled;
- (int)stillImageCapturePipeliningMode;
- (id)initWithCaptureDevice:(id)a0 inputPortTypes:(id)a1;
- (void)renderSampleBuffer:(struct opaqueCMSampleBuffer { } *)a0 forInput:(id)a1;
- (void)_configureCurrentCaptureRequestStateForFigCaptureStillImageSettings;
- (unsigned int)maxNumberOfBurstCapturesAllowedInFlight;
- (void)captureStream:(id)a0 didCapturePreBracketedEV0ImageWithPTS:(struct { long long x0; int x1; unsigned int x2; long long x3; })a1;
- (void)_commitMomentCapture;
- (void)captureStreamWillWaitForTimeMachineToFill:(id)a0;
- (void)_beginPreparingCapture;
- (void)didSelectFormat:(id)a0 forInput:(id)a1;
- (void)willStopGraph:(BOOL)a0;
- (id)_initWithCaptureDevice:(id)a0 inputPortTypes:(id)a1 allStateTransitionsHandler:(id /* block */)a2;
- (void)_setupStateMachineWithAllStateTransitionsHandler:(id /* block */)a0;
- (void)setResponsiveShutterEnabled:(BOOL)a0;
- (void)setStillImageCapturePipeliningMode:(int)a0;
- (id)_stillImageDispatchQueue;
- (void)_didResolveStillImagePTS:(struct { long long x0; int x1; unsigned int x2; long long x3; })a0 isPreBracketedEV0:(BOOL)a1;
- (void)_attemptToCompleteRequest;
- (BOOL)alwaysRequestsPreBracketedEV0;
- (int)_expectedFrameCountForCurrentRequest;
- (int)_enqueueRequestWithSettings:(id)a0 serviceRequestsIfNecessary:(BOOL)a1;
- (BOOL)supportsCameraCalibrationDataWithoutDepthForBravoConstituentPhoto;
- (void)_bufferReleased;
- (void)captureStream:(id)a0 didCaptureReferenceFrameWithPTS:(struct { long long x0; int x1; unsigned int x2; long long x3; })a1 referenceFrameBracketedCaptureSequenceNumber:(id)a2;
- (void)captureStreamDidCompleteStillImageCapture:(id)a0;
- (id)_resolveProcessingSettings;
- (void)_flushStillImageRequestWithError:(int)a0;
- (void)_beginUncommittedMomentCapture;
- (id)inputForPortType:(id)a0;
- (int)commitStillImageMomentCaptureWithSettings:(id)a0;
- (void)_beginCapture;
- (void)_cancelMomentCaptureIfNeeded;
- (void)_cancelMomentCapture;
- (void)_updateSpeedOverQualityCaptureEnabled:(BOOL *)a0 waitForTimeMachineToFill:(BOOL *)a1;
- (void)_unpackNextRequest;
- (void)setUsesHDRPreBracketFrameForErrorRecovery:(BOOL)a0;
- (void)dealloc;
- (int)beginStillImageMomentCaptureWithSettings:(id)a0;
- (int)initiateStillImageCaptureNowWithSettings:(id)a0;
- (void)_beginInitiatingCapture;
- (void)captureStream:(id)a0 stillImageCaptureError:(int)a1;
- (void)setFastCapturePrioritizationEnabled:(BOOL)a0;
- (void)_updateAllocatedShotBufferCapacityWithBufferCount:(int)a0;
- (BOOL)usesHDRPreBracketFrameForErrorRecovery;
- (int)_receivedFrameOrErrorCountForCurrentRequest;
- (void)captureStreamWillBeginStillImageCapture:(id)a0;
- (void)_serviceNextRequest;
- (void)_beginMomentCapture;

@end
