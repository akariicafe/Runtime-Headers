@class BWRamp, NSString, FigCaptureMachPortSendRight, CIContext, BWPreviewRegistration, BWPixelBufferPool, BWSpringSimulation, NSObject, NSMutableDictionary, BWFencedAnimationQueue;
@protocol BWPreviewStitcherDelegate, OS_dispatch_queue, OS_dispatch_group;

@interface BWPreviewStitcherNode : BWNode {
    struct { int width; int height; } _outputDimensions;
    int _rotationDegrees;
    BOOL _flipHorizontal;
    BOOL _flipVertical;
    double _primaryCaptureRectYInset;
    int _primaryCaptureRectPixelInset;
    double _primaryCaptureRectCenterX;
    int _primaryCaptureRectCenterXPixelOffset;
    int _primaryCaptureRectCenterXPixelOffsetFudge;
    BOOL _previewsWideBeforeSlaveStreamStarts;
    BOOL _generatesHistogram;
    int _maxLossyCompressionLevel;
    BOOL _superWideFallbackForMacroSceneEnabled;
    BOOL _haveSuperWideCamera;
    BOOL _haveTeleCamera;
    float _superWideBaseZoomFactor;
    float _wideBaseZoomFactor;
    float _teleBaseZoomFactor;
    float _superWideCorrectedBaseZoomFactor;
    float _wideBaseZoomFactorOverride;
    BOOL _wideBaseZoomFactorDynamicOverrideEnabled;
    float _wideBaseZoomFactorDynamicOverride;
    float _wideBaseZoomFactorDynamicOverrideScaled;
    float _wideBaseZoomFactorOverrideMacro;
    float _widePinholeFocalLengthInfinity;
    float _widePinholeFocalLengthMacro;
    float _dynamicWideBaseZoomFactorSmoothingFactor;
    BOOL _inputBuffersHaveHorizontalOverscanOnly;
    float _dynamicCameraScaleMSRMarginPercentage;
    float _teleBaseZoomFactorOverride;
    struct { int width; int height; } _sensorBinningFactor;
    float _shiftSmoothingFactor;
    BOOL _applyShift;
    struct CGPoint { double x; double y; } _superWideToWideBravoShift;
    struct CGPoint { double x; double y; } _wideToTeleBravoShift;
    struct OpaqueVTImageRotationSession { } *_intermediateRotationSession;
    struct OpaqueVTImageRotationSession { } *_outputRotationSession;
    struct opaqueCMFormatDescription { } *_outputFormatDescription;
    struct CGAffineTransform { double a; double b; double c; double d; double tx; double ty; } _outputTransform;
    id<BWPreviewStitcherDelegate> _delegate;
    struct os_unfair_lock_s { unsigned int _os_unfair_lock_opaque; } _configurationLock;
    BOOL _deviceIsStationary;
    BOOL _pendingRegistrationAfterDeviceBecomesStationary;
    BOOL _registrationEnabled;
    int _lastRegisteredFrameCaptureID;
    BOOL _lastRegistrationEnabled;
    int _registrationType;
    BWPreviewRegistration *_registration;
    BOOL _registrationResourcesAllocated;
    struct os_unfair_lock_s { unsigned int _os_unfair_lock_opaque; } _shiftCorrectionsUpdateLock;
    struct BWPreviewStitcherShiftCorrection { struct CGPoint { double x; double y; } currentValue; struct CGPoint { double x; double y; } updatedValue; BOOL valueIsUpdated; BOOL lastRegistrationWasValid; int registeredFrameCaptureID; BWRamp *rampX; BWRamp *rampY; } _wideToTeleShiftCorrections[3];
    struct BWPreviewStitcherShiftCorrection { struct CGPoint { double x; double y; } currentValue; struct CGPoint { double x; double y; } updatedValue; BOOL valueIsUpdated; BOOL lastRegistrationWasValid; int registeredFrameCaptureID; BWRamp *rampX; BWRamp *rampY; } _superWideToWideShiftCorrections[3];
    int _registrationFrameSkipCount;
    int _registrationUpdateRampFrameCount;
    BOOL _registerFirstFrame;
    double _primaryCameraAspectRatio;
    float _lastPrimaryCameraAspectRatio;
    FigCaptureMachPortSendRight *_fencePortSendRight;
    BOOL _displaysWidestCameraOnly;
    BOOL _displaysPrimaryCameraOnly;
    BOOL _drawWiderCameraOnly;
    BOOL _currentZoomRequiresWiderCamera;
    BOOL _lastZoomingOrSwitchingCameras;
    float _rampZoomFactorOfInterest;
    float _rampStartZoomFactor;
    NSString *_lastRecommendedMasterPortType;
    NSString *_lastPreferredMasterPortType;
    NSString *_lastNarrowerPortType;
    BOOL _lastNarrowerCameraIsTele;
    BWRamp *_teleOpacityRamp;
    BWPixelBufferPool *_teleOpacityPool;
    struct { int width; int height; } _teleOpacityPoolDimensions;
    CIContext *_teleOpacityCIContext;
    BOOL _teleOpacityRampForSuperMacroFallbackTransition;
    int _screenScale;
    BOOL _frameRateBasedRampsEnabled;
    NSObject<OS_dispatch_queue> *_ciPreheatingQueue;
    NSObject<OS_dispatch_group> *_ciPreheatingGroup;
    BOOL _havePreheatedCI;
    struct { long long value; int timescale; unsigned int flags; long long epoch; } _firstFramePTS;
    BOOL _edgeFeatheringEnabled;
    BOOL _showFeatherGradient;
    float _edgeFeatheringAspectCompensation;
    float _zoomInFeatheringInnerRadiusStart;
    float _zoomInFeatheringInnerRadiusEnd;
    float _zoomInFeatheringOuterRadiusStart;
    float _zoomInFeatheringOuterRadiusEnd;
    float _zoomOutFeatheringInnerRadiusStart;
    float _zoomOutFeatheringInnerRadiusEnd;
    float _zoomOutFeatheringOuterRadiusStart;
    float _zoomOutFeatheringOuterRadiusEnd;
    BOOL _featherEdgesForOpacityRamp;
    struct opaqueCMSampleBuffer { } *_lastSampleBuffer;
    struct { long long value; int timescale; unsigned int flags; long long epoch; } _lastRenderedPTS;
    BOOL _multiCameraStitchingEnabled;
    BOOL _aspectRatioChanging;
    long long _lastRenderTime;
    float _additionalZoomFactor;
    float _additionalZoomFactorSpringStartFactor;
    struct { long long value; int timescale; unsigned int flags; long long epoch; } _additionalZoomFactorSpringStartPTS;
    BWSpringSimulation *_additionalZoomFactorSpring;
    NSMutableDictionary *_blackFilledBorderRectsBySurfaceID;
    BOOL _forceBlackFillBorderEnabled;
    int _overCaptureStatus;
    struct BWSmartCameraScene { BOOL enabled; BOOL confident; float confidenceFilterRatio; float filteredConfidence; float confidenceThreshold; float confidenceHysteresisValueLag; short confidenceHysteresisTemporalLagBeforeConfident; short confidenceHysteresisTemporalLagBeforeNotConfident; short currentTemporalHysteresis; char *name; } _wideFocusDistanceFarEnoughForStitching;
    BOOL _hideSuperWideOverCaptureWhenTooClose;
    BOOL _superWideOccludedByWide;
    BOOL _superWideDrawingSuspendedUntilFocusImproves;
    BOOL _hideSuperWideStitchingWhenTooClose;
    BOOL _hidePartialOverCapture;
    BOOL _deviceTooHotDimmingEnabled;
    int _wideFallbackMode;
    struct BWSmartCameraScene { BOOL enabled; BOOL confident; float confidenceFilterRatio; float filteredConfidence; float confidenceThreshold; float confidenceHysteresisValueLag; short confidenceHysteresisTemporalLagBeforeConfident; short confidenceHysteresisTemporalLagBeforeNotConfident; short currentTemporalHysteresis; char *name; } _wideFocusDistanceFarEnoughToUseTele;
    BOOL _wideFocusingOneShot;
    BOOL _teleFocusingOneShot;
    BWRamp *_wideFallbackShiftRamp;
    struct CGPoint { double x; double y; } _wideFallbackRecenteringShiftOffset;
    BOOL _wantWideFallbackDueToTeleAEAF;
    BOOL _wideFallbackShiftRampTargetValueIsWide;
    int _lastRecommendedMasterSelectionReason;
    struct BWSmartCameraScene { BOOL enabled; BOOL confident; float confidenceFilterRatio; float filteredConfidence; float confidenceThreshold; float confidenceHysteresisValueLag; short confidenceHysteresisTemporalLagBeforeConfident; short confidenceHysteresisTemporalLagBeforeNotConfident; short currentTemporalHysteresis; char *name; } _wideFocusDistanceFarEnoughToUseWide;
    BWRamp *_superWideFallbackShiftRamp;
    BOOL _superWideFallbackShiftRampTargetValueIsSuperWide;
    struct CGPoint { double x; double y; } _superWideFallbackRecenteringShiftOffset;
    float _superWideFallbackRecenteringStrength;
    BOOL _wantSuperWideFallback;
    BOOL _superWideFallbackTransitioningWithStreamingPortTypesChanged;
    BOOL _superMacroUserInitiatedFallbackTuningEnabled;
    BOOL _lastSuperWideCameraFallbackWasUserInitiated;
    BOOL _inSuperMacroRange;
    BOOL _superMacroRangeRegistrationTuningEnabled;
    struct BWSmartCameraScene { BOOL enabled; BOOL confident; float confidenceFilterRatio; float filteredConfidence; float confidenceThreshold; float confidenceHysteresisValueLag; short confidenceHysteresisTemporalLagBeforeConfident; short confidenceHysteresisTemporalLagBeforeNotConfident; short currentTemporalHysteresis; char *name; } _superWideFocusDistanceFarEnoughForRegistration;
    BOOL _superMacroOpacityRampOnFullPrimaryRectEnabled;
    BOOL _superMacroEdgeFeatheringBlurEnabled;
    float _superMacroEdgeFeatheringBlurInset;
    BOOL _superMacroEdgeFeatheringShowBlurMask;
    BOOL _waitsForRegistrationToComplete;
    BWFencedAnimationQueue *_fencedAnimationQueue;
    BOOL _momentMovieRecordingEnabled;
    int _momentMovieRecordingRecenteringShiftRampFrameCount;
}

@property (nonatomic) id<BWPreviewStitcherDelegate> delegate;
@property BOOL displaysWidestCameraOnly;
@property (nonatomic) BOOL stoppingForModeSwitch;

+ (void)initialize;

- (void)_updateInputRequirements;
- (void)configurationWithID:(long long)a0 updatedFormat:(id)a1 didBecomeLiveForInput:(id)a2;
- (void)setGeneratesHistogram:(BOOL)a0;
- (id)nodeSubType;
- (struct { int x0; int x1; })outputDimensions;
- (void)didReachEndOfDataForInput:(id)a0;
- (id)nodeType;
- (void)setOutputDimensions:(struct { int x0; int x1; })a0;
- (void)setFlipVertical:(BOOL)a0;
- (void)prepareForCurrentConfigurationToBecomeLive;
- (BOOL)flipHorizontal;
- (void)renderSampleBuffer:(struct opaqueCMSampleBuffer { } *)a0 forInput:(id)a1;
- (int)rotationDegrees;
- (void)setMaxLossyCompressionLevel:(int)a0;
- (void)didSelectFormat:(id)a0 forInput:(id)a1;
- (BOOL)flipVertical;
- (void)setRotationDegrees:(int)a0;
- (BOOL)generatesHistogram;
- (void)dealloc;
- (int)maxLossyCompressionLevel;
- (void)setFlipHorizontal:(BOOL)a0;
- (id)previewRegistrationType;
- (id)initWithCameraInfoByPortType:(id)a0 sensorBinningFactor:(struct { int x0; int x1; })a1 inputBuffersHaveHorizontalOverscanOnly:(BOOL)a2 registrationType:(int)a3;
- (float)_wideFallbackRecenteringStrength;
- (void)_restitchAndEmitLastInputForAspectAndCenterChange;
- (BOOL)_displaysPrimaryCameraOnly;
- (float)_wideBaseZoomFactorWithOverrideLocked;
- (float)wideFocusDistance;
- (id)_primaryCameraPortType;
- (id)_displayStringForPortType:(id)a0;
- (void)_preheatCIRenderingAsync;
- (BOOL)_updateZoomStatusFromWideSampleBuffer:(struct opaqueCMSampleBuffer { } *)a0 teleSampleBuffer:(struct opaqueCMSampleBuffer { } *)a1;
- (struct CGPoint { double x0; double x1; })_computeBravoWideToTeleShiftFromWideSampleBuffer:(struct opaqueCMSampleBuffer { } *)a0 teleSampleBuffer:(struct opaqueCMSampleBuffer { } *)a1;
- (BOOL)_currentlyZoomingOrSwitchingCameras;
- (BOOL)_haveSuperBravo;
- (void)_updateShiftCorrectionsAsyncFromComputedShift:(struct CGPoint { double x0; double x1; })a0 byRegisteringWide:(struct opaqueCMSampleBuffer { } *)a1 tele:(struct opaqueCMSampleBuffer { } *)a2 macroTransitionType:(int)a3;
- (void)_updateAndGetWideRegionShifts:(struct CGPoint { double x0; double x1; } *)a0 teleShift:(struct CGPoint { double x0; double x1; } *)a1 wideIsSuperWide:(BOOL)a2 forComputedShift:(struct CGPoint { double x0; double x1; })a3 registrationEnabled:(BOOL)a4 currentFrameRate:(float)a5;
- (void)_updateOverCaptureStatusWithWiderSampleBuffer:(struct opaqueCMSampleBuffer { } *)a0 narrowerSampleBuffer:(struct opaqueCMSampleBuffer { } *)a1;
- (struct opaqueCMSampleBuffer { } *)_newStitchedSampleBufferFromWide:(struct opaqueCMSampleBuffer { } *)a0 tele:(struct opaqueCMSampleBuffer { } *)a1 wideRegionsShifts:(struct CGPoint { double x0; double x1; } *)a2 teleShift:(struct CGPoint { double x0; double x1; })a3 primaryCaptureRectOut:(struct CGRect { struct CGPoint { double x0; double x1; } x0; struct CGSize { double x0; double x1; } x1; } *)a4 primaryCaptureRectBeforeCroppingOut:(struct CGRect { struct CGPoint { double x0; double x1; } x0; struct CGSize { double x0; double x1; } x1; } *)a5 currentFrameRate:(float)a6;
- (void)_setOverCaptureStatus:(int)a0;
- (void)_waitForCIPreheatingToFinish;
- (float)_wideBaseZoomFactorWithOverride;
- (float)_teleBaseZoomFactorWithOverride;
- (BOOL)_currentlyRampingZoom;
- (BOOL)_currentlySwitchingCameras;
- (double)primaryCaptureRectCenterX;
- (int)_scale30FPSFrameCount:(int)a0 toFrameRate:(float)a1;
- (void)_getInputRect:(struct CGRect { struct CGPoint { double x0; double x1; } x0; struct CGSize { double x0; double x1; } x1; } *)a0 outputRect:(struct CGRect { struct CGPoint { double x0; double x1; } x0; struct CGSize { double x0; double x1; } x1; } *)a1 inputShiftAppliedInOutputRect:(struct CGPoint { double x0; double x1; } *)a2 toTransferPixelBuffer:(struct __CVBuffer { } *)a3 rect:(struct CGRect { struct CGPoint { double x0; double x1; } x0; struct CGSize { double x0; double x1; } x1; })a4 intoPixelBufferDimensions:(struct { int x0; int x1; })a5 rect:(struct CGRect { struct CGPoint { double x0; double x1; } x0; struct CGSize { double x0; double x1; } x1; })a6 withInputShift:(struct CGPoint { double x0; double x1; })a7 shiftOutsideBoundingRectAllowed:(BOOL)a8 scale:(float)a9 forFinalOutput:(BOOL)a10;
- (struct CGRect { struct CGPoint { double x0; double x1; } x0; struct CGSize { double x0; double x1; } x1; })_transferPixelBuffer:(struct __CVBuffer { } *)a0 rect:(struct CGRect { struct CGPoint { double x0; double x1; } x0; struct CGSize { double x0; double x1; } x1; })a1 intoPixelBuffer:(struct __CVBuffer { } *)a2 rect:(struct CGRect { struct CGPoint { double x0; double x1; } x0; struct CGSize { double x0; double x1; } x1; })a3 isFinalOutput:(BOOL)a4 withInputShift:(struct CGPoint { double x0; double x1; })a5 scale:(float)a6 inputSourceRectOut:(struct CGRect { struct CGPoint { double x0; double x1; } x0; struct CGSize { double x0; double x1; } x1; } *)a7;
- (id)_teleOpacityPool;
- (void)_renderOpacityRampToPixelBuffer:(struct __CVBuffer { } *)a0 bounds:(struct CGRect { struct CGPoint { double x0; double x1; } x0; struct CGSize { double x0; double x1; } x1; })a1 withWidePixelBuffer:(struct __CVBuffer { } *)a2 telePixelBuffer:(struct __CVBuffer { } *)a3 zoomingIn:(BOOL)a4 progress:(float)a5 teleBounds:(struct CGRect { struct CGPoint { double x0; double x1; } x0; struct CGSize { double x0; double x1; } x1; })a6 teleShift:(struct CGPoint { double x0; double x1; })a7;
- (float)_scaleFactorAppliedForPixelBuffer:(struct __CVBuffer { } *)a0 usedSourceRect:(struct CGRect { struct CGPoint { double x0; double x1; } x0; struct CGSize { double x0; double x1; } x1; })a1 primaryCaptureRectAspectRatio:(double)a2 metadata:(id)a3;
- (void)_callDelegateWithAppliedWiderShift:(struct CGPoint { double x0; double x1; })a0 narrowerShift:(struct CGPoint { double x0; double x1; })a1 widerScaleFactor:(float)a2 narrowerScaleFactor:(float)a3 widerPixelBuffer:(struct __CVBuffer { } *)a4 narrowerPixelBuffer:(struct __CVBuffer { } *)a5 widerPortType:(id)a6 narrowerPortType:(id)a7;
- (void)_updateUprightExifOrientationOnSampleBufferIfNeeded:(struct opaqueCMSampleBuffer { } *)a0;
- (id)_featheredImageWithTeleImage:(id)a0 wideImage:(id)a1 teleClipRect:(struct CGRect { struct CGPoint { double x0; double x1; } x0; struct CGSize { double x0; double x1; } x1; })a2 wideClipRect:(struct CGRect { struct CGPoint { double x0; double x1; } x0; struct CGSize { double x0; double x1; } x1; })a3 zoomingIn:(BOOL)a4 progress:(float)a5;
- (BOOL)_currentlyRunningShortZoomRampOrNotRampingZoom;
- (id)overCaptureStatusString;
- (int)_cameraDisplayTransitionFrameCountForCameraFallbackChange:(BOOL)a0 currentFrameRate:(float)a1;
- (int)_wideFallbackShiftRampFrameCount;
- (float)_superWideUserInitiatedFallbackRecenteringStrength;
- (int)_superWideUserInitiatedFallbackShiftRampFrameCount;
- (int)_zoomOutOpacityRampFrameCount;
- (int)_zoomInOpacityRampFrameCount;
- (int)_wideFallbackOpacityRampFrameCount;
- (int)_superWideUserInitiatedFallbackOpacityRampFrameCount;
- (id)initWithStitchingDisabled;
- (void)setPrimaryCaptureRectAspectRatio:(double)a0 center:(struct CGPoint { double x0; double x1; })a1 fencePortSendRight:(id)a2;
- (void)rampToAdditionalZoomFactor:(double)a0 momentMovieRecordingEnabled:(BOOL)a1;
- (void)setPrimaryCameraAspectRatio:(double)a0;
- (double)primaryCameraAspectRatio;
- (void)setPrimaryCaptureRectYInset:(double)a0;
- (double)primaryCaptureRectYInset;
- (void)setPrimaryCaptureRectCenterX:(double)a0;
- (void)setPreviewsWideBeforeSlaveStreamStarts:(BOOL)a0;
- (BOOL)previewsWideBeforeSlaveStreamStarts;
- (void)setSuperWideFallbackForMacroSceneEnabled:(BOOL)a0;
- (BOOL)superWideFallbackForMacroSceneEnabled;
- (void)setForceBlackFillBorderEnabled:(BOOL)a0;
- (BOOL)forceBlackFillBorderEnabled;
- (float)wideBaseZoomFactor;
- (float)superWideFocusDistance;
- (id)focusingDescription;
- (id)primaryCameraShortDisplayName;
- (BOOL)tooCloseFor1xStitching;
- (BOOL)tooCloseForSuperWideRegistration;
- (BOOL)centerRegistrationValid;
- (id)wideFallbackDescription;
- (void)setWaitsForRegistrationToComplete:(BOOL)a0;
- (BOOL)waitsForRegistrationToComplete;

@end
